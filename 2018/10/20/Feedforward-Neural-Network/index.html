<!DOCTYPE HTML>
<html class="no-js" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <!--[if lte IE 9]>
<meta http-equiv="refresh" content="0;url=http://yoursite.com/warn.html">
<![endif]-->
<meta charset="utf-8">
<meta http-equiv="X-DNS-Prefetch-Control" content="on">
<link rel="dns-prefetch" href="http://yoursite.com">
<link rel="dns-prefetch" href="//www.google-analytics.com">
<link rel="prefetch" href="http://yoursite.com">
<link rel="prefetch" href="//www.google-analytics.com">


<link rel="prerender" href="http://yoursite.com">

<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
<meta http-equiv="mobile-agent" content="format=html5; url=http://yoursite.com">
<meta name="author" content="Louis Hsu">
<link rel="stylesheet" href="/css/JSimple.css">

<link rel="shortcut icon" href="/images/favicon.png">


<title>feedforward neural network - LOUIS&#39; BLOG</title>

<meta name="keywords" content="">

<meta name="description " content="Inside! Insane!">

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                processEscapes: true
            }
        });
    </script>


    

    

</head>
<body>
<div id="nav">
    <nav class="nav-menu">
        <a class="site-name current" href="/" title="è¯´">è¯´</a>
        <a class="site-index current" href="/"><i class="fa fa-home"></i><span>Home</span></a>
        <a href="/archives" title="Archives"><i class="fa fa-archives"></i><span>Archives</span></a>
        <a href="/tags" title="Tags"><i class="fa fa-tags"></i><span>Tags</span></a>
        <!-- custom single page of menus -->
        
        
        <a href="/help" title="å¸®åŠ©">
            <i class="fa fa-question-circle"></i>
            <span>å¸®åŠ©</span>
        </a>
        
    </nav>
</div>

<div class="nav-user">
    <a class="btn-search" href="#"><i class="fa fa-search"></i></a>
    <a class="btn-read-mode" href="#"><i class="fa fa-sun-o"></i></a>
    <a class="btn-sns-qr" href="javascript:"><i class="fa fa-telegram"></i></a>
</div>

<div id="wrapper" class="clearfix">
    <div id="body">
        <div class="main" id="main">
            <div id="cover">
    <div class="cover-img"></div>
    <div class="cover-info">
        
        <h1 class="cover-siteName">è¯´IT</h1>
        <h3 class="cover-siteTitle">ç”¨ä»£ç æ‘‡æ»šè¿™ä¸ªä¸–ç•Œ</h3>
        <p class="cover-siteDesc">ä¸€ä¸ªå…³æ³¨æŠ€æœ¯ä¸äººæ–‡çš„ITåšå®¢</p>
        <div class="cover-sns">
            
    &nbsp;&nbsp;<div class="btn btn-telegram">
        <a href="http://t.me/kunyintang" target="_blank" title="telegram" ref="friend">
            <i class="fa fa-telegram"></i>
        </a>
    </div>

    &nbsp;&nbsp;<div class="btn btn-instagram">
        <a href="https://www.instagram.com/mtangsir/" target="_blank" title="instagram" ref="friend">
            <i class="fa fa-instagram"></i>
        </a>
    </div>

    &nbsp;&nbsp;<div class="btn btn-twitter">
        <a href="https://twitter.com/tangkunyin" target="_blank" title="twitter" ref="friend">
            <i class="fa fa-twitter"></i>
        </a>
    </div>

    &nbsp;&nbsp;<div class="btn btn-github">
        <a href="https://github.com/tangkunyin" target="_blank" title="github" ref="friend">
            <i class="fa fa-github"></i>
        </a>
    </div>


        </div>
    </div>
</div>

            <div class="page-title">
    <ul>
        <li><a href="/">Recent Posts</a></li>
        
        
        
        <li class="page-search">
    <form id="search" class="search-form">
        <input type="text" readonly="readonly" id="local-search-input-tip" placeholder="click to search...">
        <button type="button" disabled="disabled" class="search-form-submit"><i class="fa fa-search"></i></button>
    </form>
</li>

    </ul>
</div>
<div class="main-inner">
    <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
        <div class="post-header">
            <div class="post-author clearfix">
                <a class="avatar fleft" href="https://shuoit.net" target="_blank">
                    <img width="48" src="/images/favicon.png" alt="avatar">
                </a>
                <p><span class="label">Author</span>
                    <a href="https://shuoit.net" target="_blank">çº ç»“ä¼¦</a>
                    <span title="Last edited at&nbsp;2018-10-20">2018-10-20</span>
                </p>
                <p>ä¸€ä¸ªæ¬ğŸ§±çš„åŠ³æ–¯åŸºğŸ˜ï¸ï¸</p>
            </div>
            <h2 class="post-title">Feedforward Neural Network</h2>
            <div class="post-meta">
                emm... 14368 words in the article |
                you are the&nbsp;<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>th friend who reading now
            </div>
        </div>
        <div class="post-content markdown-body">
            <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‰é¦ˆç¥ç»ç½‘ç»œæ˜¯ä¸€ç§æœ€ç®€å•çš„ç¥ç»ç½‘ç»œï¼Œå„ç¥ç»å…ƒåˆ†å±‚æ’åˆ—ã€‚æ¯ä¸ªç¥ç»å…ƒåªä¸å‰ä¸€å±‚çš„ç¥ç»å…ƒç›¸è¿ã€‚æ¥æ”¶å‰ä¸€å±‚çš„è¾“å‡ºï¼Œå¹¶è¾“å‡ºç»™ä¸‹ä¸€å±‚ï¼å„å±‚é—´æ²¡æœ‰åé¦ˆã€‚æ˜¯ç›®å‰åº”ç”¨æœ€å¹¿æ³›ã€å‘å±•æœ€è¿…é€Ÿçš„äººå·¥ç¥ç»ç½‘ç»œä¹‹ä¸€ï¼Œæ—¢å¯ä»¥ç”¨äºè§£å†³åˆ†ç±»é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ç”¨äºè§£å†³å›å½’é—®é¢˜ã€‚</p>
<h1 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h1><p>å‰é¦ˆç¥ç»ç½‘ç»œä¹Ÿå«ä½œå¤šå±‚æ„ŸçŸ¥æœºï¼ŒåŒ…å«è¾“å…¥å±‚ï¼Œéšå«å±‚å’Œè¾“å‡ºå±‚ä¸‰ä¸ªéƒ¨åˆ†ã€‚å®ƒçš„ç›®çš„æ˜¯ä¸ºäº†å®ç°è¾“å…¥åˆ°è¾“å‡ºçš„æ˜ å°„ã€‚</p>
<script type="math/tex; mode=display">
y = f(x;W)</script><p>ç”±äºå„å±‚é‡‡ç”¨äº†éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼Œç¥ç»ç½‘ç»œå…·æœ‰è‰¯å¥½çš„éçº¿æ€§ç‰¹æ€§ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<ul>
<li>æ¿€æ´»å‡½æ•°ä¸ºçº¿æ€§å•å…ƒ<br><img src="/2018/10/20/Feedforward-Neural-Network/Linear.png" alt="Linear"></li>
<li>æ¿€æ´»å‡½æ•°ä¸ºéçº¿æ€§å•å…ƒ<br><img src="/2018/10/20/Feedforward-Neural-Network/nonLinear.png" alt="nonLinear"></li>
</ul>
<p>å‰é¦ˆç¥ç»ç½‘ç»œå¯ç”¨äºè§£å†³éçº¿æ€§çš„åˆ†ç±»æˆ–å›å½’é—®é¢˜ï¼Œå‚æ•°é€šè¿‡åå‘ä¼ æ’­ç®—æ³•<code>(Back Propagation)</code>å­¦ä¹ ã€‚</p>
<h1 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h1><h2 id="ç¥ç»å…ƒä¸ç½‘ç»œç»“æ„å›¾"><a href="#ç¥ç»å…ƒä¸ç½‘ç»œç»“æ„å›¾" class="headerlink" title="ç¥ç»å…ƒä¸ç½‘ç»œç»“æ„å›¾"></a>ç¥ç»å…ƒä¸ç½‘ç»œç»“æ„å›¾</h2><p>å•ä¸ªç¥ç»å…ƒçš„ç¤ºæ„å›¾å¦‚ä¸‹ï¼Œè¾“å…¥ä¸ºå‰ä¸€å±‚çš„è¾“å‡ºå‚æ•°$X^{(l-1)}$</p>
<script type="math/tex; mode=display">
h_{w, b}(x) = \sigma (WX + b)</script><p>$\sigma(Â·)$è¡¨ç¤ºæ¿€æ´»å‡½æ•°ã€‚</p>
<p><img src="/2018/10/20/Feedforward-Neural-Network/å•ä¸ªç¥ç»å…ƒç¤ºæ„å›¾.png" alt="å•ä¸ªç¥ç»å…ƒç¤ºæ„å›¾"></p>
<p>ä»¥ä¸‹ä¸ºå…¸å‹çš„ç¥ç»ç½‘ç»œç»“æ„å›¾<br><img src="/2018/10/20/Feedforward-Neural-Network/å‰é¦ˆç¥ç»ç½‘ç»œç»“æ„å›¾.png" alt="å‰é¦ˆç¥ç»ç½‘ç»œç»“æ„å›¾"></p>
<ul>
<li>ç¬¬ä¸€å±‚ä¸ºè¾“å…¥å±‚<code>input layer</code>ï¼Œä¸€èˆ¬ä¸è®¾ç½®æƒå€¼ï¼Œé¢„å¤„ç†åœ¨è¾“å…¥ç½‘ç»œå‰å®Œæˆï¼›</li>
<li>æœ€åä¸€å±‚ä¸ºè¾“å‡ºå±‚<code>output layer</code>ï¼›</li>
<li>å…¶ä½™å±‚ç§°ä¸ºéšè—å±‚<code>hidden layer</code>ï¼Œéšè—å±‚ç”¨äºæå–æ•°æ®ç‰¹å¾ï¼Œéšè—å±‚å±‚æ•°ä¸å„å±‚ç¥ç»å…ƒä¸ªæ•°ä¸ºè¶…å‚æ•°ã€‚</li>
</ul>
<blockquote>
<p>ç¥ç»å…ƒæƒå€¼å–å€¼ä¸åŒï¼Œå¯å®ç°ä¸åŒçš„é€»è¾‘è¿ç®—ï¼Œå•ä¸ªè¶…å¹³é¢åªèƒ½è¿›è¡ŒäºŒå…ƒåˆ’åˆ†ï¼Œåˆ©ç”¨é€»è¾‘è¿ç®—å¯å°†å¤šä¸ªè¶…å¹³é¢åˆ’åˆ†çš„åŒºåŸŸæ‹¼æ¥èµ·æ¥ï¼Œå¦‚å›¾<br><img src="/2018/10/20/Feedforward-Neural-Network/è¶…å¹³é¢åˆ’åˆ†åŒºåŸŸçš„æ‹¼æ¥.jpg" alt="è¶…å¹³é¢åˆ’åˆ†åŒºåŸŸçš„æ‹¼æ¥"></p>
<p>ä»¥ä¸‹è¯´æ˜é€»è¾‘è¿ç®—çš„å®ç°æ–¹æ³•<br><img src="/2018/10/20/Feedforward-Neural-Network/äºŒå…ƒé€»è¾‘è¿ç®—.png" alt="äºŒå…ƒé€»è¾‘è¿ç®—"><br>å…¶ä¸­</p>
<script type="math/tex; mode=display">
f(z) = \begin{cases}
    1 & z \geq 0 \\
    0 & otherwise
\end{cases}</script><ul>
<li><p>ä¸è¿ç®— $a âˆ§ b$</p>
<script type="math/tex; mode=display">w_1 = 20, w_2 = 20, b = -30</script></li>
<li><p>æˆ–è¿ç®— $a âˆ§ b$</p>
<script type="math/tex; mode=display">w_1 = 20, w_2 = 20, b = -10</script></li>
<li><p>éè¿ç®— $a = \overline{b}$</p>
<script type="math/tex; mode=display">w_1 = -20, w_2 = 0, b = 0</script></li>
<li><p>å¼‚æˆ–è¿ç®— $a \bigoplus b$ï¼Œå¯é€šè¿‡ç»„åˆè¿ç®—å®ç°</p>
<script type="math/tex; mode=display">a \bigoplus b = (\overline{a} âˆ§ b) âˆ¨ (a âˆ§ \overline{b})</script></li>
</ul>
</blockquote>
<h2 id="æ¿€æ´»å‡½æ•°"><a href="#æ¿€æ´»å‡½æ•°" class="headerlink" title="æ¿€æ´»å‡½æ•°"></a>æ¿€æ´»å‡½æ•°</h2><ul>
<li><p>éšè—å±‚çš„æ¿€æ´»å‡½æ•°ï¼Œè¯¦æƒ…å¯æŸ¥çœ‹<a href="https://louishsu.xyz/2018/10/20/%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%9A%84%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0/" target="_blank" rel="noopener">å¦ä¸€ç¯‡åšæ–‡ï¼šç¥ç»ç½‘ç»œçš„æ¿€æ´»å‡½æ•°</a>ï¼›</p>
</li>
<li><p>è¾“å‡ºå±‚çš„æ¿€æ´»å‡½æ•°</p>
<ul>
<li><p>å›å½’é—®é¢˜æ—¶ï¼Œé‡‡ç”¨çº¿æ€§å•å…ƒå³å¯</p>
<script type="math/tex; mode=display">
  f(x) = x</script></li>
<li><p>åˆ†ç±»é—®é¢˜æ—¶ï¼Œä¸€èˆ¬æœ‰ä»¥ä¸‹å‡ ç§é€‰æ‹©</p>
<ul>
<li><p>å•ç±»åˆ«æ¦‚ç‡è¾“å‡º<br>  å³æ¯ä¸ªç¥ç»å…ƒçš„è¾“å‡ºå¯¹åº”è¯¥ç±»åˆ«çš„$0-1$åˆ†å¸ƒè¾“å‡ºï¼Œè¿™å°±éœ€è¦å°†è¾“å‡ºå€¼é™åˆ¶åœ¨$[0, 1]$å†…ï¼Œä¾‹å¦‚</p>
<script type="math/tex; mode=display">P(y=1|x )= max\{0, min\{1, z\}\}</script><p>  <img src="/2018/10/20/Feedforward-Neural-Network/clf_linearout.png" alt="çº¿æ€§è¾“å‡ºå•å…ƒ"></p>
<p>  ä½†æ˜¯å¯ä»¥çœ‹åˆ°ï¼Œå½“$(w^Tx+b)$å¤„äºå•ä½åŒºé—´å¤–æ—¶ï¼Œæ¨¡å‹çš„è¾“å‡ºå¯¹å®ƒçš„å‚æ•°çš„æ¢¯åº¦éƒ½å°†ä¸º$0$ ï¼Œä¸åˆ©äºç½‘ç»œçš„è®­ç»ƒï¼Œæ•…é‡‡ç”¨$S$å½¢å‡½æ•°<code>Sigmoid</code>(<a href="https://louishsu.xyz/2018/10/18/Logistic%E5%9B%9E%E5%BD%92/" target="_blank" rel="noopener">è¯¦æƒ…</a>)</p>
<script type="math/tex; mode=display">
  P(y=1|x ) = \frac{1}{1+e^{-(w^Tx+b)}}</script><blockquote>
<p>$(1)$ <code>Sigmoid</code>å‡½æ•°å®šä¹‰åŸŸä¸º$(-\infty, \infty)$ï¼Œå€¼åŸŸä¸º$(0, 1)$ï¼Œä¸”åœ¨æ•´ä¸ªå®šä¹‰åŸŸä¸Šå•è°ƒé€’å¢ï¼Œå³ä¸ºå•å€¼å‡½æ•°ï¼Œæ•…å¯å°†çº¿æ€§è¾“å‡ºå•å…ƒçš„ç»“æœæ˜ å°„åˆ°$(0, 1)$èŒƒå›´å†…ï¼›<br>$(2)$ åœ¨å®šä¹‰åŸŸä¸Šå¤„å¤„å¯å¯¼ã€‚</p>
</blockquote>
</li>
<li><p>å¤šç±»åˆ«çš„æ¦‚ç‡è¾“å‡º<br>  å³æ¯ä¸ªç¥ç»å…ƒçš„è¾“å‡ºå¯¹åº”åˆ¤åˆ«ä¸ºè¯¥ç±»åˆ«çš„æ¦‚ç‡ï¼Œä¸”æœ‰</p>
<script type="math/tex; mode=display">
  \sum_{i=1}^C y_i = 1</script><p>  ä¾‹å¦‚</p>
<script type="math/tex; mode=display">
  y_i = \frac{z_i}{\sum_j z_j}</script><p>  ä½†æ˜¯åˆ†å¼æ±‚å¯¼å¼‚å¸¸éº»çƒ¦ï¼Œæ•…é‡‡ç”¨<code>Softmax</code>å‡½æ•°(<a href="https://louishsu.xyz/2018/10/18/softmax%E5%9B%9E%E5%BD%92/" target="_blank" rel="noopener">è¯¦æƒ…</a>)ä½œä¸ºè¾“å‡ºç»“ç‚¹çš„æ¿€æ´»å‡½æ•°ï¼Œè¯¥å‡½æ•°æ±‚å¯¼ç»“æœæ¯”è¾ƒç®€æ´ï¼Œä¸”å¯åˆ©ç”¨è¾“å‡ºè®¡ç®—å¯¼æ•°ï¼Œè®¡ç®—é‡å‡å°‘ã€‚</p>
<script type="math/tex; mode=display">
  Softmax(x) = \frac
              {1}
              {\sum_{k=1}^K exp(x_k)}
              \left[
                  \begin{matrix}
                      exp(x_1)\\
                      exp(x_2)\\
                      ...\\
                      exp(x_K)
                  \end{matrix}
              \right]</script></li>
</ul>
</li>
</ul>
</li>
</ul>
<h1 id="æŸå¤±å‡½æ•°"><a href="#æŸå¤±å‡½æ•°" class="headerlink" title="æŸå¤±å‡½æ•°"></a>æŸå¤±å‡½æ•°</h1><ul>
<li><p>å›å½’é—®é¢˜<br>  å¸¸è§çš„ç”¨äºå›å½’é—®é¢˜çš„æŸå¤±å‡½æ•°ä¸º<code>MSE</code>ï¼Œå³</p>
<script type="math/tex; mode=display">
  L(y, \hat{y}) = \frac{1}{2M} \sum_{i=1}^M (\hat{y}^{(i)} - y^{(i)})^2</script></li>
<li><p>åˆ†ç±»é—®é¢˜<br>  ä¸€èˆ¬é‡‡ç”¨äº¤å‰ç†µä½œä¸ºæŸå¤±å‡½æ•°ï¼Œå¦‚ä¸‹</p>
<script type="math/tex; mode=display">
  L(\hat{y}, y) = - \frac{1}{M} \sum_{i=1}^M 1\{y^{(i)}_j=k\} 
  \log (\hat{y}^{(i)}_j)</script><script type="math/tex; mode=display">
  1\{y^{(i)}_j=k\} = 
      \begin{cases}
          1 & y^{(i)}_j = k \\
          0 & y^{(i)}_j \neq k 
      \end{cases}ã€€j = 1, ..., N</script><p>  æˆ–è€…</p>
<script type="math/tex; mode=display">
  L(\hat{y}, y) = - \frac{1}{M} \sum_{i=1}^M 
  y^{(i)T} \log (\hat{y}^{(i)})</script><p>  å…¶ä¸­$y^{(i)}, \hat{y}^{(i)}$å‡è¡¨ç¤ºå‘é‡ï¼Œé‡‡ç”¨<code>one-hot</code>ç¼–ç ã€‚</p>
</li>
</ul>
<h1 id="æ¢¯åº¦æ¨å¯¼"><a href="#æ¢¯åº¦æ¨å¯¼" class="headerlink" title="æ¢¯åº¦æ¨å¯¼"></a>æ¢¯åº¦æ¨å¯¼</h1><p>ä»¥ä¸Šå†…å®¹ç½‘ä¸Šèµ„æ–™ä¸€å¤§å †ï¼Œè¿›å…¥é‡ç‚¹ï¼Œåå‘ä¼ æ’­æ—¶çš„æ¢¯åº¦æ¨å¯¼ï¼Œç»™å‡ºç½‘ç»œç»“æ„å¦‚ä¸‹ã€‚</p>
<ul>
<li>å›å½’ä¸åˆ†ç±»åœ¨è¾“å‡ºå±‚æœ‰æ‰€åŒºåˆ«ï¼›</li>
<li>å„å±‚æ¿€æ´»å‡½æ•°çš„è¾“å…¥å˜é‡ä»¥$z^{(l)}$è¡¨ç¤ºï¼Œè¾“å‡ºå˜é‡å‡ä»¥$x^{(l)}$è¡¨ç¤ºï¼›</li>
<li>$W^{(l)}$è¡¨ç¤ºä»ç¬¬$l$å±‚åˆ°ç¬¬$(l+1)$å±‚çš„æƒå€¼çŸ©é˜µï¼Œåˆ™$w^{(l)}_{ij}$è¡¨ç¤ºç¬¬$l$å±‚ç¬¬$j$ä¸ªç¥ç»å…ƒåˆ°$(l+1)$å±‚ç¬¬$i$ä¸ªç¥ç»å…ƒçš„è¿æ¥æƒå€¼ï¼›</li>
<li>$b^{(l)}$è¡¨ç¤ºç¬¬$l$å±‚åˆ°ç¬¬$(l+1)$å±‚çš„åç½®ï¼Œåˆ™$b^{(l)}_i$è¡¨ç¤ºåˆ°ç¬¬$(l+1)$å±‚ç¬¬$i$ä¸ªç¥ç»å…ƒçš„åç½®å€¼ï¼›</li>
<li>å„å±‚å˜é‡ç»´åº¦æ¨å¹¿ä¸ºè¾“å…¥$d_{i}$ï¼Œä¸­é—´å±‚$d_{h}$ï¼Œè¾“å‡ºå±‚$d_{o}$ï¼›</li>
<li>å…¨è¿æ¥ï¼Œéƒ¨åˆ†çº¿æ¡å·²çœç•¥ï¼Œæ¿€æ´»å‡½æ•°å·²çœç•¥ï¼›</li>
</ul>
<p><img src="/2018/10/20/Feedforward-Neural-Network/fnn.jpg" alt="FNN"></p>
<p>åˆ™å„å±‚å‚æ•°çŸ©é˜µä¸º</p>
<script type="math/tex; mode=display">
W^{(1)} = \left[
        \begin{matrix}
            w^{(1)}_{11} & ... & w^{(1)}_{1d_i} \\
            ... & ... & ... \\
            w^{(1)}_{d_h1} & ... & w^{(1)}_{d_hd_i}
        \end{matrix}
\right]ã€€
b^{(1)} = \left[
        \begin{matrix}
            b^{(1)}_{1} \\
            ... \\
            b^{(1)}_{d_h}
        \end{matrix}
\right]</script><script type="math/tex; mode=display">
W^{(2)} = \left[
        \begin{matrix}
            w^{(2)}_{11} & ... & w^{(2)}_{1d_h} \\
            ... & ... & ... \\
            w^{(2)}_{d_o1} & ... & w^{(2)}_{d_od_h}
        \end{matrix}
\right]ã€€
b^{(2)} = \left[
        \begin{matrix}
            b^{(2)}_{1} \\
            ... \\
            b^{(2)}_{d_o}
        \end{matrix}
\right]</script><p>æœ‰</p>
<script type="math/tex; mode=display">
Z^{(2)} = W^{(1)} X^{(1)} + b^{(1)}</script><script type="math/tex; mode=display">
X^{(2)} = \sigma_1 (Z^{(2)})</script><script type="math/tex; mode=display">
Z^{(3)} = W^{(2)} X^{(2)} + b^{(2)}</script><script type="math/tex; mode=display">
X^{(3)} = \sigma_2 (Z^{(3)})</script><script type="math/tex; mode=display">
X^{(1)} = Xã€€\hat{Y} = X^{(3)}</script><h2 id="å›å½’é—®é¢˜"><a href="#å›å½’é—®é¢˜" class="headerlink" title="å›å½’é—®é¢˜"></a>å›å½’é—®é¢˜</h2><p>æŸå¤±å‡½æ•°é‡‡ç”¨<code>MSE</code>ï¼Œå³</p>
<script type="math/tex; mode=display">
L(Y, \hat{Y}) = \frac{1}{M} \sum_{i=1}^M L(Y^{(i)}, \hat{Y}^{(i)})</script><script type="math/tex; mode=display">
L(Y^{(i)}, \hat{Y}^{(i)}) 
= \frac{1}{2} || \hat{Y}^{(i)} - Y^{(i)} ||_2^2
= \frac{1}{2} 
\sum_{d_2=1}^{d_o}
(\hat{y}^{(i)}_{d_2} - y^{(i)}_{d_2})^2</script><p>ä¸‹é¢æ¨å¯¼å•ä¸ªæ ·æœ¬çš„æŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œè¯¥æ‰¹æ•°æ®çš„æ¢¯åº¦ä¸ºå‡å€¼ã€‚</p>
<blockquote>
<p>çœç•¥æ ·æœ¬æ ‡è®°<code>$^{(i)}$</code></p>
</blockquote>
<ul>
<li><p>éšå«å±‚åˆ°è¾“å‡ºå±‚</p>
<ul>
<li><p>å¯¹æƒå€¼çŸ©é˜µçš„æ¢¯åº¦</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚w^{(2)}_{ij}}
  = \frac{âˆ‚}{âˆ‚w^{(2)}_{ij}} \frac{1}{2} \sum_{d_2=1}^{d_o} (\hat{y}_{d_2} - y_{d_2})^2</script><script type="math/tex; mode=display">
  = \sum_{d_2=1}^{d_o} (\hat{y}_{d_2} - y_{d_2}) \frac{âˆ‚}{âˆ‚w^{(2)}_{ij}} \hat{y}_{d_2} \tag{1}</script><p>  å…¶ä¸­</p>
<script type="math/tex; mode=display">
  \begin{cases}
      \hat{y}_{d_2} = \sigma_2 (z_{d_2}^{(3)}) \\
      z_{d_2}^{(3)} = \sum_{d_1=1}^{d_h} w^{(2)}_{d_2 d_1} x^{(2)}_{d_1} + b^{(2)}_{d_2}
  \end{cases}</script><p>  ä¸”</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚}{âˆ‚w^{(2)}_{ij}} \hat{y}_{d_2}
  = \sigma_2' (z_{d_2}^{(3)}) \frac{âˆ‚z_{d_2}^{(3)}}{âˆ‚w^{(2)}_{ij}} \tag{2}</script><script type="math/tex; mode=display">
  \frac{âˆ‚}{âˆ‚w^{(2)}_{ij}} z_{d_2}^{(3)} = 
      \begin{cases}
          x^{(2)}_{d_1} & d_1 = j, d_2 = i \\
          0 & otherwise
      \end{cases} \tag{3}</script><p>  $(3)$ä»£å…¥$(2)$ï¼Œå†ä»£å…¥$(1)$å¯å¾—åˆ°</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚w^{(2)}_{ij}}
  = (\hat{y}_{d_2} - y_{d_2}) \sigma_2' (z_{d_2}^{(3)}) x^{(2)}_{d_1} | _{d_1=j, d_2=i}
  = (\hat{y}_{i} - y_{i}) \sigma_2' (z_{i}^{(3)}) x^{(2)}_{j} \tag{*1}</script></li>
<li><p>å¯¹åç½®çŸ©é˜µçš„æ¢¯åº¦</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚b^{(2)}_i}
  = \frac{âˆ‚}{âˆ‚b^{(2)}_i} \frac{1}{2} \sum_{d_2=1}^{d_o} (\hat{y}_{d_2} - y_{d_2})^2</script><script type="math/tex; mode=display">
  = \sum_{d_2=1}^{d_o} (\hat{y}_{d_2} - y_{d_2}) \frac{âˆ‚}{âˆ‚b^{(2)}_i} \hat{y}_{d_2} \tag{4}</script><p>  å…¶ä¸­</p>
<script type="math/tex; mode=display">
  \begin{cases}
      \hat{y}_{d_2} = \sigma_2 (z_{d_2}^{(3)}) \\
      z_{d_2}^{(3)} = \sum_{d_1=1}^{d_h} w^{(2)}_{d_2 d_1} x^{(2)}_{d_1} + b^{(2)}_{d_2}
  \end{cases}</script><p>  æœ‰</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚}{âˆ‚b^{(2)}_i} z_{d_2}^{(3)} = 
      \begin{cases}
          1 &  d_2 = i \\
          0 & otherwise
      \end{cases} \tag{5}</script><p>  æ‰€ä»¥</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚b^{(2)}_i} = (\hat{y}_{d_2} - y_{d_2}) \sigma_2' (z_{d_2}^{(3)}) | _{d_2=i}
  = (\hat{y}_{i} - y_{i}) \sigma_2' (z_i^{(3)}) \tag{*2}</script></li>
</ul>
</li>
<li><p>è¾“å…¥å±‚åˆ°éšå«å±‚</p>
<ul>
<li><p>å¯¹æƒå€¼çŸ©é˜µçš„æ¢¯åº¦</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚w^{(1)}_{ij}}
  = \frac{âˆ‚}{âˆ‚w^{(1)}_{ij}} \frac{1}{2} \sum_{d_2=1}^{d_o} (\hat{y}_{d_2} - y_{d_2})^2</script><script type="math/tex; mode=display">
  = \sum_{d_2=1}^{d_o} (\hat{y}_{d_2} - y_{d_2}) \frac{âˆ‚}{âˆ‚w^{(1)}_{ij}} \hat{y}_{d_2} \tag{6}</script><p>  å…¶ä¸­</p>
<script type="math/tex; mode=display">
  \begin{cases}
      \hat{y}_{d_2} = \sigma_2 (z_{d_2}^{(3)}) \\
      z_{d_2}^{(3)} = \sum_{d_1=1}^{d_h} w^{(2)}_{d_2 d_1} x^{(2)}_{d_1} + b^{(2)}_{d_2} \\
      x^{(2)}_{d_1} = \sigma_1 (z_{d_1}^{(2)}) \\
      z_{d_1}^{(2)} = \sum_{d_0=1}^{d_i} w^{(1)}_{d_1 d_0} x^{(1)}_{d_0} + b^{(1)}_{d_1}
  \end{cases}</script><p>  æ•…</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚}{âˆ‚w^{(1)}_{ij}} \hat{y}_{d_2}
  = \frac{âˆ‚\hat{y}_{d_2}}{âˆ‚z_{d_2}^{(3)}} 
      \frac{âˆ‚z_{d_2}^{(3)}}{âˆ‚w^{(1)}_{ij}} \tag{7}</script><p>  å…¶ä¸­</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚\hat{y}_{d_2}}{âˆ‚z_{d_2}^{(3)}} 
  = \sigma_2' (z_{d_2}^{(3)})  \tag{8}</script><script type="math/tex; mode=display">
  \frac{âˆ‚z_{d_2}^{(3)}}{âˆ‚w^{(1)}_{ij}} 
  = \sum_{d1=1}^{d_h} w^{(2)}_{d_2 d_1} \frac{âˆ‚x^{(2)}_{d_1}}{âˆ‚w^{(1)}_{ij}} \tag{9}</script><script type="math/tex; mode=display">
  \frac{âˆ‚x^{(2)}_{d_1}}{âˆ‚w^{(1)}_{ij}}
  = \frac{âˆ‚x^{(2)}_{d_1}}{âˆ‚z_{d_1}^{(2)}}
      \frac{âˆ‚z_{d_1}^{(2)}}{âˆ‚w^{(1)}_{ij}}  \tag{10}</script><p>  è€Œå…¶ä¸­</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚x^{(2)}_{d_1}}{âˆ‚z_{d_1}^{(2)}} = x^{(2)}_{d_1} = \sigma_1' (z_{d_1}^{(2)}) \tag{11}</script><script type="math/tex; mode=display">
  \frac{âˆ‚z_{d_1}^{(2)}}{âˆ‚w^{(1)}_{ij}} = 
  \begin{cases}
      x^{(1)}_{d_0} & d_1 = i, d_0 = j\\
      0 & otherwise
  \end{cases} \tag{12}</script><p>  $(11),(12)$ä»£å…¥$(10)$å¾—åˆ°</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚x^{(2)}_{d_1}}{âˆ‚w^{(1)}_{ij}} = 
  \sigma_1' (z_{d_1}^{(2)})
      x^{(1)}_{d_0} | _{d_1 = i, d_0 = j} \tag{13}</script><p>  $(13)$ä»£å›$(9)$ï¼Œæœ‰</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚z_{d_2}^{(3)}}{âˆ‚w^{(1)}_{ij}} 
  = \sum_{d1=1}^{d_h} 
  \left[
      w^{(2)}_{d_2 d_1} 
      \sigma_1' (z_{d_1}^{(2)})
      x^{(1)}_{d_0}
  \right] | _{d_1 = i, d_0 = j}</script><script type="math/tex; mode=display">
  = w^{(2)}_{d_2 i} 
      \sigma_1' (z_i^{(2)})
      x^{(1)}_j \tag{14}</script><p>  å°†$(8),(14)$ä»£å…¥$(7)$å¾—åˆ°</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚}{âˆ‚w^{(1)}_{ij}} \hat{y}_{d_2}
  = \sigma_2' (z_{d_2}^{(3)}) 
       w^{(2)}_{d_2 i} 
      \sigma_1' (z_i^{(2)})
      x^{(1)}_j \tag{15}</script><p>  $(15)$ä»£å…¥$(6)$æœ‰</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚w^{(1)}_{ij}}
  = \sum_{d_2=1}^{d_o} 
      (\hat{y}_{d_2} - y_{d_2})      
      \sigma_2' (z_{d_2}^{(3)}) 
       w^{(2)}_{d_2 i} 
      \sigma_1' (z_i^{(2)})
      x^{(1)}_j \tag{*3}</script></li>
<li><p>å¯¹åç½®çŸ©é˜µçš„æ¢¯åº¦</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚b^{(1)}_i}
  = \frac{âˆ‚}{âˆ‚b^{(1)}_i} \frac{1}{2} \sum_{d_2=1}^{d_o} (\hat{y}_{d_2} - y_{d_2})^2</script><script type="math/tex; mode=display">
  = \sum_{d_2=1}^{d_o} (\hat{y}_{d_2} - y_{d_2}) \frac{âˆ‚}{âˆ‚b^{(1)}_i} \hat{y}_{d_2} \tag{16}</script><p>  åŒç†å¯å¾—</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚}{âˆ‚b^{(1)}_i} \hat{y}_{d_2}
  = \sigma_2' (z_{d_2}^{(3)}) 
       w^{(2)}_{d_2 i} 
      \sigma_1' (z_i^{(2)})  \tag{17}</script><p>  æ‰€ä»¥</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚b^{(1)}_i} =
  \sum_{d_2=1}^{d_o} 
      (\hat{y}_{d_2} - y_{d_2})      
      \sigma_2' (z_{d_2}^{(3)}) 
       w^{(2)}_{d_2 i} 
      \sigma_1' (z_i^{(2)}) \tag{*4}</script></li>
</ul>
</li>
</ul>
<p>ç»¼ä¸Šæ‰€è¿°</p>
<script type="math/tex; mode=display">
\frac{âˆ‚L}{âˆ‚w^{(2)}_{ij}}
= (\hat{y}_{i} - y_{i}) 
    \sigma_2' (z_{i}^{(3)}) x^{(2)}_{j}</script><script type="math/tex; mode=display">
\frac{âˆ‚L}{âˆ‚b^{(2)}_i} 
= (\hat{y}_{i} - y_{i}) 
    \sigma_2' (z_i^{(3)})</script><script type="math/tex; mode=display">
\frac{âˆ‚L}{âˆ‚w^{(1)}_{ij}}
= \sum_{d_2=1}^{d_o} 
    (\hat{y}_{d_2} - y_{d_2})      
    \sigma_2' (z_{d_2}^{(3)}) 
    w^{(2)}_{d_2 i} 
    \sigma_1' (z_i^{(2)})
    x^{(1)}_j</script><script type="math/tex; mode=display">
\frac{âˆ‚L}{âˆ‚b^{(1)}_i} 
= \sum_{d_2=1}^{d_o} 
    (\hat{y}_{d_2} - y_{d_2})      
    \sigma_2' (z_{d_2}^{(3)}) 
    w^{(2)}_{d_2 i} 
    \sigma_1' (z_i^{(2)})</script><p>ä»¤</p>
<script type="math/tex; mode=display">
\begin{cases}
    \delta^{(2)}_i 
    = (\hat{y}_{i} - y_{i}) 
        \sigma_2' (z_i^{(3)}) \\
    \delta^{(1)}_i 
    = \sum_{d_2=1}^{d_o} 
        \delta^{(2)}_{d_2} 
        w^{(2)}_{d_2 i} 
        \sigma_1' (z_i^{(2)})
\end{cases}</script><p>æœ‰</p>
<script type="math/tex; mode=display">
\begin{cases}
    \frac{âˆ‚L}{âˆ‚w^{(2)}_{ij}} = \delta^{(2)}_i x^{(2)}_{j}\\
    \frac{âˆ‚L}{âˆ‚b^{(2)}_i}    = \delta^{(2)}_i\\
    \frac{âˆ‚L}{âˆ‚w^{(1)}_{ij}} = \delta^{(1)}_i x^{(1)}_j\\
    \frac{âˆ‚L}{âˆ‚b^{(1)}_i}    = \delta^{(1)}_i
\end{cases}</script><p>è‡³æ­¤æ¨å¯¼å®Œæ¯•ã€‚</p>
<blockquote>
<p>å½“éšè—å±‚é‡‡ç”¨<code>Sigmoid</code>å‡½æ•°ï¼Œè¾“å‡ºå±‚é‡‡ç”¨çº¿æ€§å•å…ƒï¼Œå¯å¾—åˆ°</p>
<script type="math/tex; mode=display">
\sigma_1' (z_i^{(2)}) 
= \sigma_1 (z_i^{(2)}) 
    \left[1 - \sigma_1 (z_i^{(2)}) \right]
= x_i^{(2)} (1 - x_i^{(2)})</script><script type="math/tex; mode=display">
\sigma_2' (z_i^{(3)}) = z_i^{(3)}</script><p>æ­¤æ—¶</p>
<script type="math/tex; mode=display">
\begin{cases}
    \frac{âˆ‚L}{âˆ‚w^{(2)}_{ij}} = (\hat{y}_{i} - y_{i}) z_i^{(3)} x^{(2)}_{j} \\
    \frac{âˆ‚L}{âˆ‚b^{(2)}_i}    = (\hat{y}_{i} - y_{i}) z_i^{(3)} \\
    \frac{âˆ‚L}{âˆ‚w^{(1)}_{ij}} = \sum_{d_2=1}^{d_o} \delta^{(2)}_{d_2} w^{(2)}_{d_2 i} z_i^{(2)} x^{(1)}_j \\
    \frac{âˆ‚L}{âˆ‚b^{(1)}_i}    = \sum_{d_2=1}^{d_o} \delta^{(2)}_{d_2} w^{(2)}_{d_2 i} z_i^{(2)}
\end{cases}</script><p>å¯ä»¥çœ‹åˆ°ï¼Œè®¡ç®—æ¢¯åº¦æ—¶ä½¿ç”¨çš„æ•°æ®åœ¨ä¸Šä¸€æ¬¡å‰å‘ä¼ æ’­æ—¶å·²è®¡ç®—å¾—ï¼Œæ•…å¯å‡å°‘è®¡ç®—é‡ã€‚</p>
</blockquote>
<h2 id="åˆ†ç±»é—®é¢˜"><a href="#åˆ†ç±»é—®é¢˜" class="headerlink" title="åˆ†ç±»é—®é¢˜"></a>åˆ†ç±»é—®é¢˜</h2><p>æŸå¤±å‡½æ•°é‡‡ç”¨<code>Cross Entropy</code>ï¼Œå³</p>
<script type="math/tex; mode=display">
L(\hat{y}, y) = 
\frac{1}{M} \sum_{i=1}^M L(\hat{y}^{(i)}, y^{(i)})</script><script type="math/tex; mode=display">
L(\hat{y}^{(i)}, y^{(i)}) 
= - y^{(i)T} \log (\hat{y}^{(i)})</script><p>ä¸Šå¼ä¸­ï¼Œ$y^{(i)}, \hat{y}^{(i)}$å‡ä¸ºåˆ—å‘é‡ï¼Œä¸”$y^{(i)}$è¡¨ç¤º<code>one-hot</code>ç¼–ç åçš„æ ‡ç­¾å‘é‡ï¼Œä¹Ÿå¯å†™ä½œ</p>
<script type="math/tex; mode=display">
L(\hat{y}^{(i)}, y^{(i)})
= - \log \hat{y}^{(i)}_{y^{(i)}}</script><ul>
<li>ç”±è¯¥å¼å¯ä»¥çœ‹å‡ºï¼Œè‹¥è¾“å‡ºå±‚æ¿€æ´»å‡½æ•°é‡‡ç”¨<code>Sigmoid</code>ä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œåˆ™éšè—å±‚â€”â€”è¾“å‡ºå±‚ä¹‹é—´æƒå€¼çŸ©é˜µ$W^{(2)}$åªä¼šæ›´æ–°$w^{(i)}_{y^{(i)} d_1}, d_1 = 1, â€¦, d_h$ï¼›</li>
<li>ä¸€èˆ¬é‡‡ç”¨<code>SoftMax</code>ä½œä¸ºè¾“å‡ºå±‚æ¿€æ´»å‡½æ•°ï¼Œ<code>Sigmoid</code>ä¸‹é¢ä¸ä½œæ¨å¯¼ã€‚</li>
</ul>
<blockquote>
<p>å…³äº<code>SoftMax</code>çš„æ¢¯åº¦ï¼Œç§»æ­¥<a href="https://louishsu.xyz/2018/10/18/softmax%E5%9B%9E%E5%BD%92/" target="_blank" rel="noopener">SoftMax Regression</a>ä¸­æŸ¥çœ‹è¯¦ç»†æ¨å¯¼è¿‡ç¨‹ï¼Œè¿™é‡Œç›´æ¥ç»™å‡ºç»“è®ºã€‚<br>å¯¹äº</p>
<script type="math/tex; mode=display">
S(x) = \frac {1} {\sum_{k=1}^K exp(x_k)} \left[ \begin{matrix} exp(x_1)\\ exp(x_2)\\ ...\\ exp(x_K) \end{matrix} \right]</script><p>å…¶æ¢¯åº¦ä¸º</p>
<script type="math/tex; mode=display">
\frac{âˆ‚S(x)}{âˆ‚x_i}_{KÃ—1} =  \left[ \begin{matrix} 0\\ ...\\ p_i\\ ...\\ 0 \end{matrix} \right] -  \left[ \begin{matrix} p_i p_1\\ ...\\ p_i^2\\ ...\\ p_i p_K \end{matrix} \right]
= \left( \left[ \begin{matrix}  0 \\ ...\\ 1\\ ...\\ 0 \end{matrix} \right] - p \right)p_i</script><p>çœç•¥æ ·æœ¬æ ‡è®°<code>$^{(i)}$</code></p>
</blockquote>
<ul>
<li><p>éšå«å±‚åˆ°è¾“å‡ºå±‚</p>
<ul>
<li><p>å¯¹æƒå€¼çŸ©é˜µçš„æ¢¯åº¦</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚w^{(2)}_{ij}}
  = - \frac{âˆ‚}{âˆ‚w^{(2)}_{ij}} \log \hat{y}_{y}
  = - \frac{1}{\hat{y}_y} 
      \frac{âˆ‚\hat{y}_{y}}{âˆ‚w^{(2)}_{ij}} \tag{18}</script><p>  å…¶ä¸­$\hat{y}_{y}$ä¸$z^{(3)}_{d_2}(d_2 = 1, â€¦, d_o) $å‡æœ‰è”ç³»ï¼Œæ•…</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚\hat{y}_{y}}{âˆ‚w^{(2)}_{ij}}
  = \sum_{d2=1}^{d_o} 
      \frac{âˆ‚\hat{y}_{y}}{âˆ‚z^{(3)}_{d_2}} 
      \frac{âˆ‚z^{(3)}_{d_2}}{âˆ‚w^{(2)}_{ij}} \tag{19}</script><p>  è€Œ</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚\hat{y}_{y}}{âˆ‚z^{(3)}_{d_2}}
  = \begin{cases}
      \hat{y}_{y} (1 - \hat{y}_{d_2}) & d_2 = y \\
      - \hat{y}_{y} \hat{y}_{d_2} & otherwise
  \end{cases}</script><script type="math/tex; mode=display">
  \frac{âˆ‚z^{(3)}_{d_2}}{âˆ‚w^{(2)}_{ij}}
  = \begin{cases}
      x^{(2)}_{d_1} & i = d_2, j = d_1 \\
      0 & otherwise
  \end{cases}</script><blockquote>
<p>$z^{(3)}_{d_2} = \sum_{d_1=0}^{d_h} w^{(2)}_{d_2d_1} x^{(2)}_{d_1} + b^{(2)}_{d_2}$</p>
</blockquote>
<p>  ä»£å›$(19)$ï¼Œå†å¸¦å›$(18)$ï¼Œæœ‰</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚w^{(2)}_{ij}}
  = - \frac{1}{\hat{y}_{y}} 
      \sum_{d_2=1}^{d_o} 
      \frac{âˆ‚\hat{y}_{y}}{âˆ‚z^{(3)}_{d_2}} 
      x^{(2)}_{d_1} | _{d_2=i, d_1=j}</script><script type="math/tex; mode=display">
  = \begin{cases}
      - \frac{1}{\hat{y}_{y}} \hat{y}_{y} (1 - \hat{y}_i) x^{(2)}_j & i = y \\
      - \frac{1}{\hat{y}_{y}} (- \hat{y}_{y} \hat{y}_i) x^{(2)}_j & otherwise
  \end{cases}</script><script type="math/tex; mode=display">
  = \begin{cases}
      (\hat{y}_i - 1) x^{(2)}_j & i = y \\
      \hat{y}_i x^{(2)}_j & otherwise
  \end{cases}</script><p>  å³</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚w^{(2)}_{ij}}
  = (\hat{y}_i - y_i) x^{(2)}_j \tag{*5}</script></li>
<li><p>å¯¹åç½®çŸ©é˜µçš„æ¢¯åº¦</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚b^{(2)}_i}
  = \hat{y}_i - y_i \tag{*6}</script></li>
</ul>
</li>
<li><p>è¾“å…¥å±‚åˆ°éšå«å±‚</p>
<ul>
<li><p>å¯¹æƒå€¼çŸ©é˜µçš„æ¢¯åº¦</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚w^{(1)}_{ij}}
  = - \frac{âˆ‚}{âˆ‚w^{(1)}_{ij}} \log \hat{y}_{y}
  = - \frac{1}{\hat{y}_{y}} 
      \frac{âˆ‚\hat{y}_{y}}{âˆ‚w^{(1)}_{ij}} \tag{20}</script><p>  å…¶ä¸­</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚\hat{y}_{y}}{âˆ‚w^{(1)}_{ij}}
  = \sum_{d_2=1}^{d_o} 
      \frac{âˆ‚\hat{y}_{y}}{âˆ‚z^{(3)}_{d_2}} 
      \frac{âˆ‚z^{(3)}_{d_2}}{âˆ‚w^{(1)}_{ij}} \tag{21}</script><p>  $\frac{âˆ‚z^{(3)}_{d_2}}{âˆ‚w^{(1)}_{ij}}$éƒ¨åˆ†ä¸å›å½’ç›¸åŒï¼Œæœ‰</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚z_{d_2}^{(3)}}{âˆ‚w^{(1)}_{ij}}
  = w^{(2)}_{d_2 i} \sigma_1' (z_i^{(2)}) x^{(1)}_j</script><p>  ç”±ä¸Šé¢åˆ†æå¯å¾—</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚\hat{y}_{y}}{âˆ‚z^{(3)}_{d_2}}
  = \begin{cases}
      \hat{y}_{y} (1 - \hat{y}_{d_2}) & d_2 = y \\
      - \hat{y}_{y} \hat{y}_{d_2} & otherwise
  \end{cases}</script><p>  æ•…ä»£å›$(20)$å¯å¾—åˆ°</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚w^{(1)}_{ij}}
  = - \frac{1}{\hat{y}_{y}}
      \sum_{d_2=1}^{d_o} 
      \frac{âˆ‚\hat{y}_{y}}{âˆ‚z^{(3)}_{d_2}} 
      \frac{âˆ‚z^{(3)}_{d_2}}{âˆ‚w^{(1)}_{ij}}</script><script type="math/tex; mode=display">
  = - \frac{1}{\hat{y}_{y}}
      \sum_{d_2=1}^{d_o} 
      \frac{âˆ‚\hat{y}_{y}}{âˆ‚z^{(3)}_{d_2}} 
      w^{(2)}_{d_2 i} \sigma_1' (z_i^{(2)}) x^{(1)}_j</script><script type="math/tex; mode=display">
  = \left[ 
      \sum_{d_2=1, d_2 \neq y}^{d_o} \hat{y}_{d_2} w^{(2)}_{d_2 i} + 
      (\hat{y}_y - 1) w^{(2)}_{y i} 
  \right] \sigma_1' (z_i^{(2)}) x^{(1)}_j</script><script type="math/tex; mode=display">
  = \left[ 
      \sum_{d_2=1}^{d_o} \hat{y}_{d_2} w^{(2)}_{d_2 i} - 
      w^{(2)}_{y i}
  \right] \sigma_1' (z_i^{(2)}) x^{(1)}_j \tag{*7}</script></li>
<li><p>å¯¹åç½®çŸ©é˜µçš„æ¢¯åº¦</p>
<script type="math/tex; mode=display">
  \frac{âˆ‚L}{âˆ‚b^{(1)}_i}
  = \left[ 
      \sum_{d_2=1}^{d_o} \hat{y}_{d_2} w^{(2)}_{d_2 i} - 
      w^{(2)}_{y i}
  \right] \sigma_1' (z_i^{(2)}) \tag{*8}</script></li>
</ul>
</li>
</ul>
<p>è‡³æ­¤æ¨å¯¼å®Œæ¯•ã€‚</p>
<blockquote>
<p>è¿™ä¸ªæ¨å¯¼ï¼Œä»…ä¾›å‚è€ƒ</p>
</blockquote>
<h1 id="è¿‡æ‹Ÿåˆé—®é¢˜"><a href="#è¿‡æ‹Ÿåˆé—®é¢˜" class="headerlink" title="è¿‡æ‹Ÿåˆé—®é¢˜"></a>è¿‡æ‹Ÿåˆé—®é¢˜</h1><p>å’Œå…¶ä»–ç®—æ³•ä¸€æ ·ï¼Œå‰é¦ˆç¥ç»ç½‘ç»œä¹Ÿå­˜åœ¨è¿‡æ‹Ÿåˆçš„é—®é¢˜ï¼Œè§£å†³æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§</p>
<ul>
<li><p>æ­£åˆ™åŒ–<br>  ä¸çº¿æ€§å›å½’ç±»ä¼¼ï¼Œç¥ç»ç½‘ç»œä¹Ÿå¯ä»¥åŠ å…¥èŒƒæ•°æƒ©ç½šé¡¹ï¼Œä»¥ä¸‹$C$è¡¨ç¤ºæ™®é€šçš„æŸå¤±å‡½æ•°ï¼Œ$\lambda$ä¸ºæƒ©ç½šç³»æ•°ï¼Œ$n$ä¸ºæ ·æœ¬æ•°ç›®ï¼Œ$w$è¡¨ç¤ºæƒå€¼å‚æ•°ã€‚</p>
<ul>
<li><code>L1</code>æ­£åˆ™åŒ–<br>  æƒ©ç½šé¡¹ä¸ºç½‘ç»œæ‰€æœ‰æƒå€¼çš„ç»å¯¹å€¼ä¹‹å’Œã€‚<script type="math/tex; mode=display">
  C = C_0 + \frac{\lambda}{n} \sum_w |w|</script></li>
<li><code>L2</code>æ­£åˆ™åŒ–<br>  åˆç§°æƒå€¼è¡°å‡<code>weights decay</code>ï¼Œæƒ©ç½šé¡¹ä¸ºç½‘ç»œæ‰€æœ‰æƒå€¼çš„å¹³æ–¹å’Œã€‚<script type="math/tex; mode=display">
  C = C_0 + \frac{\lambda}{2n} \sum_w w^2</script></li>
</ul>
</li>
<li><p>Dropout<br>  ä»¥æ¦‚ç‡å¤§å°ä¸º<code>p</code>ä½¿éƒ¨åˆ†ç¥ç»å…ƒè¾“å‡ºå€¼ç›´æ¥ä¸º0ï¼Œå¦‚æ­¤å¯ä»¥ä½¿åå‘ä¼ æ’­æ—¶ç›¸å…³æƒå€¼ç³»æ•°ä¸åšæ›´æ–°ï¼Œåªæœ‰è¢«ä¿ç•™ä¸‹æ¥çš„æƒå€¼å’Œåç½®å€¼ä¼šè¢«æ›´æ–°ã€‚<br>  <img src="/2018/10/20/Feedforward-Neural-Network/dropout_1.png" alt="dropout_1"><br>  <img src="/2018/10/20/Feedforward-Neural-Network/dropout_2.png" alt="dropout_2"></p>
</li>
<li><p>å¢åŠ è®­ç»ƒæ•°æ®å¤§å°<br>  å¯åœ¨åŸæ•°æ®ä¸ŠåŠ ä»¥å˜æ¢æˆ–å™ªå£°ï¼Œå›¾åƒçš„æ‰©å¢æ–¹æ³•å¯æŸ¥çœ‹<a href="https://louishsu.xyz/2018/11/02/%E5%9B%BE%E5%83%8F%E6%95%B0%E6%8D%AE%E9%9B%86%E6%89%A9%E5%A2%9E-Augment-%E6%96%B9%E6%B3%95/" target="_blank" rel="noopener">å›¾åƒæ•°æ®é›†æ‰©å¢</a>ã€‚</p>
</li>
</ul>
<h1 id="ç¨‹åº"><a href="#ç¨‹åº" class="headerlink" title="ç¨‹åº"></a>ç¨‹åº</h1><p><a href="https://github.com/isLouisHsu/Python-Examples-for-PyTorch-Tutorial/blob/master/NeuralNetwork_ANN_MNIST.py" target="_blank" rel="noopener">@Github: Code of Neural Network</a></p>
<p>ä½¿ç”¨<code>PyTorch</code>å®ç°ç¥ç»ç½‘ç»œï¼Œä»¥ä¸‹ä¸ºæ¨¡å‹å®šä¹‰<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class AnnNet(nn.Module):</span><br><span class="line">    def __init__(self):</span><br><span class="line">        super(AnnNet, self).__init__()</span><br><span class="line">        self.input_size = 28 * 28</span><br><span class="line">        self.hidden_size = 100</span><br><span class="line">        self.output_size = 10</span><br><span class="line">        self.fc1 = nn.Linear(self.input_size,  self.hidden_size)    # input   - hidden</span><br><span class="line">        self.fc2 = nn.Linear(self.hidden_size, self.output_size )   # hidden  - output</span><br><span class="line">        # self.activate = nn.Sigmoid()  # å‚æ•°æ›´æ–°éå¸¸æ…¢ï¼Œç‰¹åˆ«æ˜¯å±‚æ•°å¤šæ—¶</span><br><span class="line">        self.activate = nn.ReLU()       # äº‹å®è¯æ˜ReLUä½œä¸ºæ¿€æ´»å‡½æ•°æ›´åŠ åˆé€‚</span><br><span class="line">        self.softmax = nn.Softmax()</span><br><span class="line">    def forward(self, X):</span><br><span class="line">        h = self.activate(self.fc1(X))</span><br><span class="line">        y_pred = self.softmax(self.fc2(h))</span><br><span class="line">        return y_pred</span><br></pre></td></tr></table></figure></p>

        </div>
        <div class="post-tool">
            <a class="btn-thumbs-up" href="javascript:void(0);" data-cid="52" title="95">
                <i class="fa fa-thumbs-up" aria-hidden="true"></i> Donate
            </a>
        </div>
        
        <div class="post-tags">Tagsï¼š
            
        </div>
        
    </article>
    
    <p style="text-align: center">This article just represents my own viewpoint. If there is something wrong, please correct me.</p>
    
    

    

</div>
<script src="/js/busuanzi.pure.mini.js"></script>


        </div><!-- end #main-->
    </div><!-- end #body -->
    <footer class="footer">
    <div class="footer-inner" style="text-align: center">
        <p>
            <a href="/about" title="About">About</a>&nbsp;&nbsp<em>Â·</em>&nbsp;&nbsp
            <!-- è‡ªå®šä¹‰é“¾æ¥ -->
            <a href="/help" title="Help">Help</a>&nbsp;&nbsp<em>Â·</em>&nbsp;&nbsp
            <a href="/links" title="Links">Links</a>&nbsp;&nbsp<em>Â·</em>&nbsp;&nbsp
            <a href="/sitemap.xml" title="SiteMap">SiteMap</a>
        </p>
        <p>
            Has been established&nbsp<a href="/timeline" id="siteBuildingTime"></a>&nbspDaysï¼Œ<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="licence">Based on Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</a><br>
            Â©2017-<span id="cpYear"></span> Based on&nbsp<a href="http://hexo.io" target="_blank" rel="nofollow">Hexo</a>
            ï¼ŒTheme by&nbsp&nbsp<a href="https://github.com/tangkunyin/hexo-theme-jsimple" target="_blank" rel="bookmark">JSimple</a>
            ï¼ŒAuthor&nbsp<a href="https://shuoit.net" target="_blank" rel="friend">çº ç»“ä¼¦</a>
            ï¼ŒHosted by <a href="https://pages.github.com/" target="_blank" rel="nofollow">GitHub Pages</a>
        </p>
    </div>
</footer>
<script src="/js/SimpleCore.js"></script>

</div>
<!-- search pop -->
<div class="popup search-popup local-search-popup">
    <div class="local-search-header clearfix">
        <span class="search-icon">
            <i class="fa fa-search"></i>
        </span>
        <span class="popup-btn-close">
            <i class="fa fa-times-circle"></i>
        </span>
        <div class="local-search-input-wrapper">
            <input id="local-search-input" spellcheck="false" type="text" autocomplete="off" placeholder="Input query keywords here...">
        </div>
    </div>
    <div id="local-search-result"></div>
</div>
<div class="fixed-btn">
    <a class="btn-gotop" href="javascript:"> <i class="fa fa-angle-up"></i></a>
</div>
<script>
    $(function () {
        var jsi_config = {
            buildingTime: '01/20/2018',
            current: $('.post-tags').length > 0 ? 'post' : 'archive',
            snsQRCode: '/images/sns-qrcode.png',
            donateImg: '/images/donate-qr.png',
            localSearch: { dbPath: '' },
            readMode: 'day'
        };
        
            jsi_config.localSearch = {
                dbPath: '/search.xml',
                trigger: 'auto',
                topN: '1',
                unescape: 'false'
            }
        
        SimpleCore.init(jsi_config);
        
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
