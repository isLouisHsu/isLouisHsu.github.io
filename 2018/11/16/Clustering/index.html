<!DOCTYPE HTML>
<html class="no-js" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
    <!--[if lte IE 9]>
<meta http-equiv="refresh" content="0;url=http://yoursite.com/warn.html">
<![endif]-->
<meta charset="utf-8">
<meta http-equiv="X-DNS-Prefetch-Control" content="on">
<link rel="dns-prefetch" href="http://yoursite.com">
<link rel="dns-prefetch" href="//www.google-analytics.com">
<link rel="prefetch" href="http://yoursite.com">
<link rel="prefetch" href="//www.google-analytics.com">


<link rel="prerender" href="http://yoursite.com">

<meta http-equiv="X-UA-Compatible" content="IE=Edge">
<meta name="renderer" content="webkit">
<meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
<meta http-equiv="mobile-agent" content="format=html5; url=http://yoursite.com">
<meta name="author" content="Louis Hsu">
<link rel="stylesheet" href="/css/JSimple.css">

<link rel="shortcut icon" href="/images/favicon.png">


<title>clustering - LOUIS&#39; BLOG</title>

<meta name="keywords" content="">

<meta name="description " content="Inside! Insane!">

    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                processEscapes: true
            }
        });
    </script>


    

    

</head>
<body>
<div id="nav">
    <nav class="nav-menu">
        <a class="site-name current" href="/" title="è¯´">è¯´</a>
        <a class="site-index current" href="/"><i class="fa fa-home"></i><span>Home</span></a>
        <a href="/archives" title="Archives"><i class="fa fa-archives"></i><span>Archives</span></a>
        <a href="/tags" title="Tags"><i class="fa fa-tags"></i><span>Tags</span></a>
        <!-- custom single page of menus -->
        
        
        <a href="/help" title="å¸®åŠ©">
            <i class="fa fa-question-circle"></i>
            <span>å¸®åŠ©</span>
        </a>
        
    </nav>
</div>

<div class="nav-user">
    <a class="btn-search" href="#"><i class="fa fa-search"></i></a>
    <a class="btn-read-mode" href="#"><i class="fa fa-sun-o"></i></a>
    <a class="btn-sns-qr" href="javascript:"><i class="fa fa-telegram"></i></a>
</div>

<div id="wrapper" class="clearfix">
    <div id="body">
        <div class="main" id="main">
            <div id="cover">
    <div class="cover-img"></div>
    <div class="cover-info">
        
        <h1 class="cover-siteName">è¯´IT</h1>
        <h3 class="cover-siteTitle">ç”¨ä»£ç æ‘‡æ»šè¿™ä¸ªä¸–ç•Œ</h3>
        <p class="cover-siteDesc">ä¸€ä¸ªå…³æ³¨æŠ€æœ¯ä¸äººæ–‡çš„ITåšå®¢</p>
        <div class="cover-sns">
            
    &nbsp;&nbsp;<div class="btn btn-telegram">
        <a href="http://t.me/kunyintang" target="_blank" title="telegram" ref="friend">
            <i class="fa fa-telegram"></i>
        </a>
    </div>

    &nbsp;&nbsp;<div class="btn btn-instagram">
        <a href="https://www.instagram.com/mtangsir/" target="_blank" title="instagram" ref="friend">
            <i class="fa fa-instagram"></i>
        </a>
    </div>

    &nbsp;&nbsp;<div class="btn btn-twitter">
        <a href="https://twitter.com/tangkunyin" target="_blank" title="twitter" ref="friend">
            <i class="fa fa-twitter"></i>
        </a>
    </div>

    &nbsp;&nbsp;<div class="btn btn-github">
        <a href="https://github.com/tangkunyin" target="_blank" title="github" ref="friend">
            <i class="fa fa-github"></i>
        </a>
    </div>


        </div>
    </div>
</div>

            <div class="page-title">
    <ul>
        <li><a href="/">Recent Posts</a></li>
        
            
                <li class="">
                    <a href="/categories/tech-notes" data-name="æŠ€æœ¯">æŠ€æœ¯</a>
                </li>
            
                <li class="">
                    <a href="/categories/humanities" data-name="äººæ–‡">äººæ–‡</a>
                </li>
            
                <li class="">
                    <a href="/categories/others" data-name="å…¶ä»–">å…¶ä»–</a>
                </li>
            
        
        <li class="page-search">
    <form id="search" class="search-form">
        <input type="text" readonly="readonly" id="local-search-input-tip" placeholder="click to search...">
        <button type="button" disabled="disabled" class="search-form-submit"><i class="fa fa-search"></i></button>
    </form>
</li>

    </ul>
</div>
<div class="main-inner">
    <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
        <div class="post-header">
            <div class="post-author clearfix">
                <a class="avatar fleft" href="https://shuoit.net" target="_blank">
                    <img width="48" src="/images/favicon.png" alt="avatar">
                </a>
                <p><span class="label">Author</span>
                    <a href="https://shuoit.net" target="_blank">çº ç»“ä¼¦</a>
                    <span title="Last edited at&nbsp;2018-11-16">2018-11-16</span>
                </p>
                <p>ä¸€ä¸ªæ¬ğŸ§±çš„åŠ³æ–¯åŸºğŸ˜ï¸ï¸</p>
            </div>
            <h2 class="post-title">Clustering</h2>
            <div class="post-meta">
                emm... 28215 words in the article |
                you are the&nbsp;<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>th friend who reading now
            </div>
        </div>
        <div class="post-content markdown-body">
            <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è¿™æ˜¯ç¬¬ä¸€ç¯‡å…³äºæ— ç›‘ç£å­¦ä¹ çš„åšæ–‡ï¼Œæ— ç›‘ç£çš„å­¦ä¹ åˆ™ä¸æ˜¯å°è¯•é¢„æµ‹ä»»ä½•ä¸œè¥¿ï¼Œè€Œæ˜¯å¯»æ‰¾æ•°æ®ä¸­çš„ç‰¹å¾ï¼Œåœ¨æ— ç›‘ç£å­¦ä¹ ä¸­ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„æ–¹æ³•ç§°ä¸ºèšç±»ï¼Œæ˜¯æŠŠå…·æœ‰ç›¸åŒç‰¹å¾çš„æ•°æ®èšé›†åœ¨ä¸€ç»„ã€‚</p>
<h1 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h1><h2 id="è·ç¦»åº¦é‡æ–¹æ³•"><a href="#è·ç¦»åº¦é‡æ–¹æ³•" class="headerlink" title="è·ç¦»åº¦é‡æ–¹æ³•"></a>è·ç¦»åº¦é‡æ–¹æ³•</h2><p>æœºå™¨å­¦ä¹ ä¸­è·ç¦»åº¦é‡æ–¹æ³•æœ‰å¾ˆå¤šï¼Œä»¥ä¸‹ç®€å•ä»‹ç»å‡ ç§ã€‚</p>
<blockquote>
<p><a href="https://blog.csdn.net/taotiezhengfeng/article/details/80492128" target="_blank" rel="noopener">æœºå™¨å­¦ä¹ å¸¸ç”¨çš„è·ç¦»åº¦é‡æ–¹æ³• - taotiezhengfengçš„åšå®¢ - CSDNåšå®¢</a><br><a href="https://blog.csdn.net/u014782458/article/details/58180885" target="_blank" rel="noopener">ç®—æ³•ä¸­çš„å„ç§è·ç¦»ï¼ˆæ¬§å¼è·ç¦»ï¼Œé©¬æ°è·ç¦»ï¼Œé—µå¯å¤«æ–¯åŸºè·ç¦»â€¦â€¦ï¼‰ - å•Šå“¦123çš„åšå®¢ - CSDNåšå®¢ </a></p>
</blockquote>
<p>å®šä¹‰ä¸¤ä¸ª$n$ç»´å‘é‡</p>
<script type="math/tex; mode=display">
x = [x_1, x_2, ..., x_n]^T</script><script type="math/tex; mode=display">
y = [y_1, y_2, ..., y_n]^T</script><ul>
<li><p>æ›¼å“ˆé¡¿è·ç¦»<code>(Manhattan Distance)</code></p>
<script type="math/tex; mode=display">
  d = || x - y ||_1 = \sum_i |x_i - y_i|</script></li>
<li><p>æ¬§æ°è·ç¦»<code>(Euclidean Distance)</code></p>
<script type="math/tex; mode=display">
  d = || x - y ||_2 = \sqrt{\sum_i (x_i - y_i)^2}</script></li>
<li><p>é—½å¯å¤«æ–¯åŸºè·ç¦»<code>(Minkowski Distance)</code></p>
<script type="math/tex; mode=display">
  d = || x - y ||_p = \left(\sum_i | x_i - y_i |^{p} \right)^{\frac{1}{p}}</script><p>  å½“$p$å–$1$æ—¶ä¸ºæ›¼å“ˆé¡¿è·ç¦»ï¼Œå–$2$æ—¶ä¸ºæ¬§å¼è·ç¦»ã€‚</p>
</li>
<li><p>ä½™å¼¦è·ç¦»<code>(Cosine)</code></p>
<script type="math/tex; mode=display">
  d = \frac{x^T y}{||x||_2 ||y||_2} = \frac{\sum_i x_i y_i}{\sqrt{\sum_i x_i^2} \sqrt{\sum_i y_i^2}}</script><blockquote>
<p>çªç„¶æƒ³åˆ°ä¸ºä»€ä¹ˆå‘é‡çš„å¤¹è§’ä½™å¼¦æ˜¯æ€ä¹ˆæ¥çš„ï¼Œé«˜ä¸­å­¦ä¹ ä¸€ç›´èƒŒçš„å…¬å¼ï¼Œç°åœ¨ç»™ä¸€ä¸‹è¯æ˜ã€‚<br>è¯æ˜ï¼šå‘é‡çš„å¤¹è§’å…¬å¼<br><img src="/2018/11/16/Clustering/cosine_distance.png" alt="cosine_distance"></p>
<p>ä»ä½™å¼¦å®šç†(ä½™å¼¦å®šç†ç”¨å‡ ä½•å³å¯)å‡ºå‘ï¼Œæœ‰</p>
<script type="math/tex; mode=display">
\cos \theta = \frac{a^2+b^2-c^2}{2ab}</script><p>å…¶ä¸­</p>
<script type="math/tex; mode=display">
||\vec{a}|| = \sqrt{x_1^2 + y_1^2}</script><script type="math/tex; mode=display">
||\vec{b}|| = \sqrt{x_2^2 + y_2^2}</script><script type="math/tex; mode=display">
||\vec{c}|| = \sqrt{(x_1 - x_2)^2 + (x_2 - y_2)^2}</script><p>æ•…</p>
<script type="math/tex; mode=display">
\cos \theta = \frac
  {(\sqrt{x_1^2 + y_1^2})^2 + (\sqrt{x_2^2 + y_2^2})^2 - (\sqrt{(x_1 - x_2)^2 + (x_2 - y_2))^2}}
  {2 \sqrt{x_1^2 + y_1^2} \sqrt{x_2^2 + y_2^2}}</script><script type="math/tex; mode=display">
= \frac
  {x_1 x_2 + y_1 y_2}
  {\sqrt{x_1^2 + y_1^2} \sqrt{x_2^2 + y_2^2}}
  = \frac{a^T b}{||a||Â·||b||}</script></blockquote>
</li>
</ul>
<h2 id="hard-vs-soft-clustering"><a href="#hard-vs-soft-clustering" class="headerlink" title="hard vs. soft clustering"></a>hard vs. soft clustering</h2><ul>
<li>ç¡¬èšç±»<code>(hard clustering)</code><br>  è®¡ç®—çš„æ˜¯ä¸€ä¸ªç¡¬åˆ†é…<code>(hard ssignment)</code>è¿‡ç¨‹,å³æ¯ä¸ªæ ·æœ¬ä»…ä»…å±äºä¸€ä¸ªç°‡ã€‚</li>
<li>è½¯èšç±»<code>(soft clustering)</code><br>  åˆ†é…è¿‡ç¨‹æ˜¯è½¯çš„ï¼Œå³ä¸€ä¸ªæ ·æœ¬çš„åˆ†é…ç»“æœæ˜¯åœ¨æ‰€æœ‰ç°‡ä¸Šçš„ä¸€ä¸ªåˆ†å¸ƒï¼Œåœ¨è½¯åˆ†é…ç»“æœä¸­ï¼Œä¸€ä¸ªæ ·æœ¬å¯èƒ½å¯¹å¤šä¸ªç°‡éƒ½å…·æœ‰éš¶å±åº¦ã€‚</li>
</ul>
<h2 id="èšç±»æ–¹æ³•çš„åˆ†ç±»"><a href="#èšç±»æ–¹æ³•çš„åˆ†ç±»" class="headerlink" title="èšç±»æ–¹æ³•çš„åˆ†ç±»"></a>èšç±»æ–¹æ³•çš„åˆ†ç±»</h2><ul>
<li>åˆ’åˆ†æ–¹æ³•<br>  <code>K-means</code>ï¼Œ<code>K-medoids</code>ï¼Œ<code>GMM</code>ç­‰ã€‚</li>
<li>å±‚æ¬¡æ–¹æ³•<br>  <code>AGNES</code>ï¼Œ<code>DIANA</code>ï¼Œ<code>BIRCH</code>ï¼Œ<code>CURE</code>å’Œ<code>CURE-NS</code>ç­‰ã€‚</li>
<li>åŸºäºå¯†åº¦çš„æ–¹æ³•<br>  <code>DBSCAN</code>ï¼Œ<code>OPTICS</code>ï¼Œ<code>DENCLUE</code>ç­‰ã€‚</li>
<li>å…¶ä»–<br>  å¦‚<code>STING</code>ç­‰ã€‚</li>
</ul>
<h1 id="å¸¸ç”¨èšç±»æ–¹æ³•"><a href="#å¸¸ç”¨èšç±»æ–¹æ³•" class="headerlink" title="å¸¸ç”¨èšç±»æ–¹æ³•"></a>å¸¸ç”¨èšç±»æ–¹æ³•</h1><h2 id="Kå‡å€¼-K-means"><a href="#Kå‡å€¼-K-means" class="headerlink" title="Kå‡å€¼(K-means)"></a>Kå‡å€¼(K-means)</h2><p>æ˜¯æœ€ä¸ºç»å…¸çš„åŸºäºåˆ’åˆ†çš„èšç±»æ–¹æ³•ï¼Œæ˜¯åå¤§ç»å…¸æ•°æ®æŒ–æ˜ç®—æ³•ä¹‹ä¸€ï¼Œé€šå¸¸ç”¨äºå¯»æ‰¾æ¬¡ä¼˜è§£ï¼Œå†é€šè¿‡å…¶ä»–ç®—æ³•(å¦‚<code>GMM</code>)å¯»æ‰¾æ›´ä¼˜çš„èšç±»ç»“æœã€‚</p>
<h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>ç»™å®š$N$ç»´æ•°æ®é›†</p>
<script type="math/tex; mode=display">
X = [x^{(1)}, x^{(2)}, ..., x^{(M)}]</script><p>æŒ‡å®šç±»åˆ«æ•°$K$ä¸åˆå§‹ä¸­å¿ƒç‚¹$\mu^{(0)}$ï¼Œå°†æ ·æœ¬åˆ’åˆ†åˆ°ä¸­å¿ƒç‚¹è·ç¦»å…¶æœ€è¿‘çš„ç°‡ä¸­ï¼Œå†æ ¹æ®æœ¬æ¬¡åˆ’åˆ†æ›´æ–°å„ç°‡çš„ä¸­å¿ƒ$\mu^{(t)}$ï¼Œå¦‚æ­¤è¿­ä»£ç›´è‡³å¾—åˆ°æœ€å¥½çš„èšç±»ç»“æœã€‚é¢„æµ‹æµ‹è¯•æ ·æœ¬æ—¶ï¼Œå°†å…¶åˆ’åˆ†åˆ°ä¸­å¿ƒç‚¹è·å…¶æœ€è¿‘çš„ç°‡ï¼Œä¹Ÿå¯é€šè¿‡<code>KNN</code>ç­‰æ–¹æ³•ã€‚</p>
<p>ä¸€èˆ¬ä½¿ç”¨æ¬§å¼è·ç¦»åº¦é‡æ ·æœ¬åˆ°å„ä¸­å¿ƒç‚¹çš„è·ç¦»ï¼Œä¹Ÿå¯é€‰æ‹©ä½™å¼¦è·ç¦»ç­‰ï¼Œè¿™ä¹Ÿæ˜¯<code>K-means</code>ç®—æ³•çš„å…³é”®</p>
<script type="math/tex; mode=display">
D(x^{(i)}, \mu_k) = || x^{(i)} - \mu_k ||_2^2</script><p>å®šä¹‰æŸå¤±å‡½æ•°ä¸º</p>
<script type="math/tex; mode=display">
J(\Omega) = \sum_i \sum_k r^{(i)}_k D(x^{(i)}, \mu_k)</script><p>å…¶ä¸­</p>
<script type="math/tex; mode=display">
r^{(i)}_k = \begin{cases}
    1 & x^{(i)} \in C_k \\
    0 & otherwise
\end{cases}</script><p>æˆ–è¡¨ç¤ºä¸º</p>
<script type="math/tex; mode=display">
r^{(i)} = [0, ..., 1_k, ..., 0]^T</script><p>åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ï¼ŒæŸå¤±å‡½æ•°çš„å€¼ä¸æ–­ä¸‹é™ï¼Œä¼˜åŒ–ç›®æ ‡ä¸º</p>
<script type="math/tex; mode=display">
\min J(\Omega)</script><h3 id="è®¡ç®—æ­¥éª¤"><a href="#è®¡ç®—æ­¥éª¤" class="headerlink" title="è®¡ç®—æ­¥éª¤"></a>è®¡ç®—æ­¥éª¤</h3><ol>
<li>éšæœºé€‰å–$K$ä¸ªä¸­å¿ƒç‚¹ï¼›</li>
<li>éå†æ‰€æœ‰æ•°æ®ï¼Œè®¡ç®—æ¯ä¸ªç‚¹åˆ°å„ä¸­å¿ƒç‚¹çš„è·ç¦»ï¼›</li>
<li>å°†æ¯ä¸ªæ•°æ®åˆ’åˆ†åˆ°æœ€è¿‘çš„ä¸­å¿ƒç‚¹ä¸­ï¼›</li>
<li>è®¡ç®—æ¯ä¸ªèšç±»çš„å¹³å‡å€¼ï¼Œä½œä¸ºæ–°çš„ä¸­å¿ƒç‚¹ï¼›</li>
<li>é‡å¤æ­¥éª¤2-æ­¥éª¤4ï¼Œç›´åˆ°è¿™kä¸ªä¸­çº¿ç‚¹ä¸å†å˜åŒ–(æ”¶æ•›)ï¼Œæˆ–æ‰§è¡Œäº†è¶³å¤Ÿå¤šçš„è¿­ä»£ï¼›</li>
</ol>
<p><code>K-means</code>æ›´æ–°è¿­ä»£è¿‡ç¨‹å¦‚ä¸‹å›¾<br><img src="/2018/11/16/Clustering/kmeans_example.gif" alt="kmeans_example"></p>
<h3 id="ç¼ºç‚¹ä¸éƒ¨åˆ†è§£å†³æ–¹æ³•"><a href="#ç¼ºç‚¹ä¸éƒ¨åˆ†è§£å†³æ–¹æ³•" class="headerlink" title="ç¼ºç‚¹ä¸éƒ¨åˆ†è§£å†³æ–¹æ³•"></a>ç¼ºç‚¹ä¸éƒ¨åˆ†è§£å†³æ–¹æ³•</h3><ul>
<li>å±€éƒ¨æœ€ä¼˜</li>
<li>åˆå€¼æ•æ„Ÿ<br>  åˆå§‹ç‚¹çš„é€‰æ‹©ä¼šå½±å“<code>K-means</code>èšç±»çš„ç»“æœï¼Œå³å¯èƒ½ä¼šé™·å…¥å±€éƒ¨æœ€ä¼˜è§£ï¼Œå¦‚ä¸‹å›¾<br>  <img src="/2018/11/16/Clustering/k_means_init.png" alt="k_means_init"><br>  å¯é€šè¿‡å¦‚ä¸‹æ–¹æ³•è§£å†³<ul>
<li>å¤šæ¬¡é€‰æ‹©åˆå§‹ç‚¹è¿è¡Œ<code>K-means</code>ç®—æ³•ï¼Œé€‰æ‹©æœ€ä¼˜çš„ä½œä¸ºè¾“å‡ºç»“æœï¼›</li>
<li><code>K-means++</code></li>
</ul>
</li>
<li>éœ€è¦å®šä¹‰<code>mean</code>ï¼Œå¯¹äºæ ‡ç§°å‹<code>(categorical)</code>æ•°æ®ä¸é€‚ç”¨</li>
<li>éœ€è¦ç»™å®šèšç±»ç°‡æ•°ç›®$K$<br>  è¿™é‡Œç»™å‡ºä¸€ç§é€‰æ‹©ç°‡æ•°ç›®çš„æ–¹æ³•ï¼Œé€‰æ‹©å¤šä¸ª$K$å€¼è¿›è¡Œèšç±»ï¼Œè®¡ç®—ä»£ä»·å‡½æ•°ï¼ŒåšæˆæŠ˜çº¿å›¾åå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨$K=3$å¤„æŸå¤±å€¼çš„å˜åŒ–ç‡å‡ºç°è¾ƒå¤§å˜åŒ–ï¼Œåˆ™å¯é€‰æ‹©ç°‡çš„æ•°ç›®ä¸º$3$ã€‚<br>  <img src="/2018/11/16/Clustering/k_means_choose_K.png" alt="k_means_choose_K"></li>
<li>å™ªå£°æ•°æ®å¹²æ‰°å¤§</li>
<li>å¯¹äºéå‡¸é›†<code>(non-convex)</code>æ•°æ®æ— èƒ½ä¸ºåŠ›<br>  è°±èšç±»å¯è§£å†³éå‡¸é›†æ•°æ®çš„èšç±»é—®é¢˜ã€‚</li>
</ul>
<h3 id="æ”¹è¿›"><a href="#æ”¹è¿›" class="headerlink" title="æ”¹è¿›"></a>æ”¹è¿›</h3><ul>
<li><code>K-means++</code><br>  æ”¹è¿›åˆå§‹ç‚¹é€‰æ‹©æ–¹æ³•ï¼Œç¬¬$1$ä¸ªä¸­å¿ƒç‚¹éšæœºé€‰æ‹©ï¼›ä¹‹åçš„åˆå§‹ä¸­å¿ƒç‚¹æ ¹æ®å‰é¢é€‰æ‹©çš„ä¸­å¿ƒç‚¹å†³å®šï¼Œè‹¥å·²é€‰å–$n$ä¸ªåˆå§‹èšç±»ä¸­å¿ƒ$(0&lt;n&lt;K)$ï¼Œé€‰å–ç¬¬$n+1$ä¸ªèšç±»ä¸­å¿ƒæ—¶ï¼Œè·ç¦»å½“å‰$n$ä¸ªèšç±»ä¸­å¿ƒè¶Šè¿œçš„ç‚¹ä¼šæœ‰æ›´é«˜çš„æ¦‚ç‡è¢«é€‰ä¸ºç¬¬$n+1$ä¸ªèšç±»ä¸­å¿ƒã€‚</li>
<li><code>ISODATA</code><br>  æ€æƒ³ï¼šå½“å±äºæŸä¸ªç±»åˆ«çš„æ ·æœ¬æ•°è¿‡å°‘æ—¶æŠŠè¿™ä¸ªç±»åˆ«å»é™¤ï¼Œå½“å±äºæŸä¸ªç±»åˆ«çš„æ ·æœ¬æ•°è¿‡å¤šã€åˆ†æ•£ç¨‹åº¦è¾ƒå¤§æ—¶æŠŠè¿™ä¸ªç±»åˆ«åˆ†ä¸ºä¸¤ä¸ªå­ç±»åˆ«.</li>
<li><code>Kernel K-means</code><br>  å‚ç…§æ”¯æŒå‘é‡æœºä¸­æ ¸å‡½æ•°çš„æ€æƒ³ï¼Œå°†æ‰€æœ‰æ ·æœ¬æ˜ å°„åˆ°å¦å¤–ä¸€ä¸ªç‰¹å¾ç©ºé—´ä¸­å†è¿›è¡Œèšç±»ã€‚</li>
</ul>
<h3 id="ç±»ä¼¼çš„ç®—æ³•"><a href="#ç±»ä¼¼çš„ç®—æ³•" class="headerlink" title="ç±»ä¼¼çš„ç®—æ³•"></a>ç±»ä¼¼çš„ç®—æ³•</h3><p>ä¸<code>K-means</code>ç±»ä¼¼çš„ç®—æ³•æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚</p>
<ul>
<li><code>K-medoids</code><br>  <code>K-means</code>çš„å–å€¼èŒƒå›´å¯ä»¥æ˜¯è¿ç»­ç©ºé—´ä¸­çš„ä»»æ„å€¼ï¼Œè¦æ±‚æ‰€æœ‰æ•°æ®æ ·æœ¬å¤„åœ¨ä¸€ä¸ªæ¬§å¼ç©ºé—´ä¸­ï¼Œå¯¹äºæœ‰å¾ˆå¤šå™ªå£°çš„æ•°æ®å°±ä¼šé€ æˆæå¤§çš„è¯¯å·®ã€‚<code>K-medoids</code>çš„å–å€¼æ˜¯æ•°æ®æ ·æœ¬èŒƒå›´ä¸­çš„æ ·æœ¬ï¼Œä¸”å¯åº”ç”¨åœ¨éæ•°å€¼å‹æ•°æ®æ ·æœ¬ä¸Šã€‚</li>
<li><code>k-medians</code><br>  $K$ä¸­å€¼ï¼Œé€‰æ‹©ä¸­ä½æ•°æ›´æ–°å„ç°‡çš„ä¸­å¿ƒç‚¹ã€‚</li>
<li><code>K-centers</code><br>  <a href="https://www.bjdxs.com/xueshu/28151.html" target="_blank" rel="noopener">æ··åˆç±»å‹æ•°æ®çš„K-Centersèšç±»ç®—æ³•/The K-Centers Clustering Algorithm for Categorical and Mixe</a></li>
</ul>
<h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p><a href="https://github.com/isLouisHsu/Basic-Machine-Learning-Algorithm/blob/master/Andrew%20Ng%2C%20Stanford%20University/mlclass-ex7-1-kmeans/KMeans.py" target="_blank" rel="noopener">@Github: K-Means</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">class KMeans():</span><br><span class="line">    def __init__(self, n_cluster, mode):</span><br><span class="line">        self.n_cluster = n_cluster  # ç°‡çš„ä¸ªæ•°</span><br><span class="line">        self.mode = mode            # è·ç¦»åº¦é‡æ–¹å¼</span><br><span class="line">        self.centroids = None       # ç°‡çš„ä¸­å¿ƒ</span><br><span class="line">        self.loss = float(&apos;inf&apos;)    # ä¼˜åŒ–ç›®æ ‡å€¼</span><br><span class="line">        plt.ion()</span><br><span class="line">    def fit(self, X, max_iter=5, min_move=0.1, display=False):</span><br><span class="line">        def initializeCentroids():</span><br><span class="line">            &apos;&apos;&apos;</span><br><span class="line">            é€‰æ‹©åˆå§‹ç‚¹</span><br><span class="line">            &apos;&apos;&apos;</span><br><span class="line">            centroid = np.zeros(shape=(self.n_cluster, X.shape[1])) # ä¿å­˜é€‰å‡ºçš„ç‚¹</span><br><span class="line">            pointIdx = []                                           # ä¿å­˜å·²é€‰å‡ºçš„ç‚¹çš„ç´¢å¼•</span><br><span class="line">            for n in range(self.n_cluster):</span><br><span class="line">                idx = np.random.randint(0, X.shape[0])              # éšæœºé€‰æ‹©ä¸€ä¸ªç‚¹</span><br><span class="line">                while idx in pointIdx:                              # è‹¥è¯¥ç‚¹å·²é€‰å‡ºï¼Œåˆ™ä¸¢å¼ƒé‡æ–°é€‰æ‹©</span><br><span class="line">                    idx = np.random.randint(0, X.shape[0])</span><br><span class="line">                pointIdx.append(idx)</span><br><span class="line">                centroid[n] = X[idx]</span><br><span class="line">            return centroid</span><br><span class="line">        def dist2Centroids(x, centroids, mode):</span><br><span class="line">            &apos;&apos;&apos;</span><br><span class="line">            è¿”å›å‘é‡xåˆ°kä¸ªä¸­å¿ƒç‚¹çš„è·ç¦»å€¼</span><br><span class="line">            &apos;&apos;&apos;</span><br><span class="line">            d = np.zeros(shape=(self.n_cluster,))</span><br><span class="line">            for n in range(self.n_cluster):</span><br><span class="line">                d[n] = mathFunc.distance(x, centroids[n], mode)</span><br><span class="line">            return d</span><br><span class="line">        def nearestInfo(centroids, mode):</span><br><span class="line">            &apos;&apos;&apos;</span><br><span class="line">            æ¯ä¸ªç‚¹æœ€è¿‘çš„ç°‡ä¸­å¿ƒç´¢å¼•ã€è·ç¦»</span><br><span class="line">            &apos;&apos;&apos;</span><br><span class="line">            ctIdx = -np.ones(shape=(X.shape[0],), dtype=np.int8)    # æ¯ä¸ªç‚¹æœ€è¿‘çš„ç°‡ä¸­å¿ƒç´¢å¼•ï¼Œåˆå§‹åŒ–ä¸º-1ï¼Œå¯ä½œä¸ºå¼‚å¸¸æ¡ä»¶</span><br><span class="line">            ctDist = np.ones(shape=(X.shape[0],), dtype=np.float)   # æ¯ä¸ªç‚¹åˆ°æœ€è¿‘ç°‡ä¸­å¿ƒçš„è·ç¦»</span><br><span class="line">            for i in range(X.shape[0]):</span><br><span class="line">                dists = dist2Centroids(X[i], centroids, mode)</span><br><span class="line">                if mode == &apos;Euclidean&apos;: ctIdx[i] = np.argmin(dists)</span><br><span class="line">                elif mode == &apos;Cosine&apos;:  ctIdx[i] = np.argmax(dists)</span><br><span class="line">                ctDist[i] = dists[ctIdx[i]]             # ä¿å­˜æœ€ç›¸ä¼¼çš„è·ç¦»åº¦é‡ï¼Œç”¨äºè®¡ç®—loss</span><br><span class="line">            return ctIdx, ctDist</span><br><span class="line">        def updateCentroids(ctIdx):</span><br><span class="line">            &apos;&apos;&apos;</span><br><span class="line">            æ›´æ–°ç°‡ä¸­å¿ƒ</span><br><span class="line">            &apos;&apos;&apos;</span><br><span class="line">            centroids = np.zeros(shape=(self.n_cluster, X.shape[1]))</span><br><span class="line">            for n in range(self.n_cluster):</span><br><span class="line">                X_ = X[ctIdx == n]                      # ç­›é€‰å‡ºç¦»ç°‡ä¸­å¿ƒCnæœ€è¿‘çš„æ ·æœ¬ç‚¹</span><br><span class="line">                centroids[n] = np.mean(X_, axis=0)      # æ ¹æ®ç­›é€‰å‡ºçš„æ ·æœ¬ç‚¹æ›´æ–°ä¸­å¿ƒå€¼</span><br><span class="line">            return centroids</span><br><span class="line">        def loss(dist):</span><br><span class="line">            return np.mean(dist**2)</span><br><span class="line">        # -----------------------------------------</span><br><span class="line">        loss_min = float(&apos;inf&apos;)                         # æœ€ä¼˜åˆ†ç±»æ—¶çš„æŸå¤±å€¼ï¼Œæœ€å°</span><br><span class="line">        n_iter = 0     </span><br><span class="line">        while n_iter &lt; max_iter:                        # æ¯æ¬¡è¿­ä»£é€‰æ‹©ä¸åŒçš„åˆå§‹ç‚¹</span><br><span class="line">            n_iter += 1; isDone = False                 # è¡¨ç¤ºæœ¬æ¬¡è¿­ä»£æ˜¯å¦å·²æ”¶æ•›</span><br><span class="line">            centroids_tmp = initializeCentroids()       # é€‰æ‹©æœ¬æ¬¡è¿­ä»£çš„åˆå§‹ç‚¹</span><br><span class="line">            loss_last = float(&apos;inf&apos;)                    # æœ¬æ¬¡è¿­ä»£ä¸­ï¼Œä¸­å¿ƒç‚¹æ›´æ–°å‰çš„æŸå¤±å€¼</span><br><span class="line">            n_update = 0                                # æœ¬æ¬¡è¿­ä»£çš„æ›´æ–°æ¬¡æ•°è®¡æ•°</span><br><span class="line">            while not isDone:</span><br><span class="line">                n_update += 1</span><br><span class="line">                ctIdx, ctDist = nearestInfo(centroids_tmp, mode=self.mode)</span><br><span class="line">                centroids_tmp = updateCentroids(ctIdx)  # æ›´æ–°ç°‡ä¸­å¿ƒ</span><br><span class="line">                # --- å¯è§†åŒ– ---</span><br><span class="line">                if (display==True) and (X.shape[1] == 2):</span><br><span class="line">                    plt.ion()</span><br><span class="line">                    plt.figure(n_iter); plt.cla()</span><br><span class="line">                    plt.scatter(X[:, 0], X[:, 1], c=ctIdx)</span><br><span class="line">                    plt.scatter(centroids_tmp[:, 0], centroids_tmp[:, 1], c=&apos;r&apos;)</span><br><span class="line">                    plt.pause(0.5)</span><br><span class="line">                # -------------</span><br><span class="line">                loss_now = loss(ctDist); moved = np.abs(loss_last - loss_now)</span><br><span class="line">                if moved &lt; min_move:                    # è‹¥ç§»åŠ¨è¿‡å°ï¼Œåˆ™æœ¬æ¬¡è¿­ä»£æ”¶æ•›</span><br><span class="line">                    isDone = True</span><br><span class="line">                    print(&apos;ç¬¬%dæ¬¡è¿­ä»£ç»“æŸï¼Œä¸­å¿ƒç‚¹æ›´æ–°%dæ¬¡&apos; % (n_iter, n_update))</span><br><span class="line">                else: loss_last = loss_now</span><br><span class="line">            if loss_now &lt; loss_min:</span><br><span class="line">                self.centroids = centroids_tmp          # ä¿å­˜æŸå¤±æœ€å°çš„æ¨¡å‹(æœ€ä¼˜)</span><br><span class="line">                loss_min = loss_now</span><br><span class="line">                # print(&apos;èšç±»ç»“æœå·²æ›´æ–°&apos;)</span><br><span class="line">        self.loss = loss_min</span><br><span class="line">        print(&apos;=========== è¿­ä»£ç»“æŸ ===========&apos;)</span><br><span class="line">    def predict(self, X):</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        å„ä¸ªæ ·æœ¬çš„æœ€è¿‘ç°‡ä¸­å¿ƒç´¢å¼•</span><br><span class="line">        &apos;&apos;&apos;</span><br><span class="line">        labels = -np.ones(shape=(X.shape[0],), dtype=np.int)    # åˆå§‹åŒ–ä¸º-1ï¼Œå¯ç”¨ä½œå¼‚å¸¸æ¡ä»¶</span><br><span class="line">        for i in range(X.shape[0]):</span><br><span class="line">            dists_i = np.zeros(shape=(self.n_cluster,))         # ä¿å­˜X[i]åˆ°ä¸­å¿ƒç‚¹Cnçš„è·ç¦»</span><br><span class="line">            for n in range(self.n_cluster):</span><br><span class="line">                dists_i[n] = mathFunc.distance(X[i], self.centroids[n], mode=self.mode)</span><br><span class="line">            if self.mode == &apos;Euclidean&apos;:</span><br><span class="line">                labels[i] = np.argmin(dists_i)</span><br><span class="line">            elif self.mode == &apos;Cosine&apos;:</span><br><span class="line">                labels[i] = np.argmax(dists_i)</span><br><span class="line">        return labels</span><br></pre></td></tr></table></figure></p>
<p>ç°‡æ•°çš„é€‰æ‹©ä»£ç å¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">def chooseBestK(X, start, stop, step=1, mode=&apos;Euclidean&apos;):</span><br><span class="line">    Ks = np.arange(start, stop + 1, step, dtype=np.int) # å¾…é€‰æ‹©çš„K</span><br><span class="line">    Losses = np.zeros(shape=Ks.shape)                   # ä¿å­˜ä¸åŒKå€¼æ—¶çš„æœ€å°æŸå¤±å€¼</span><br><span class="line">    for k in range(1, Ks.shape[0] + 1):                 # å¯¹äºä¸åŒçš„Kï¼Œè®­ç»ƒæ¨¡å‹ï¼Œè®¡ç®—æŸå¤±</span><br><span class="line">        print(&apos;K = %d&apos;, k)</span><br><span class="line">        estimator = KMeans(n_cluster=k, mode=mode)</span><br><span class="line">        estimator.fit(X, max_iter=10, min_move=0.01, display=False)</span><br><span class="line">        Losses[k - 1] = estimator.loss</span><br><span class="line">    plt.ioff()</span><br><span class="line">    plt.figure(); plt.xlabel(&apos;n_clusters&apos;); plt.ylabel(&apos;loss&apos;)</span><br><span class="line">    plt.plot(Ks, Losses)                                # åšå‡ºloss-Kæ›²çº¿</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure></p>
<h2 id="å‡å€¼æ¼‚ç§»-Meanshift"><a href="#å‡å€¼æ¼‚ç§»-Meanshift" class="headerlink" title="å‡å€¼æ¼‚ç§»(Meanshift)"></a>å‡å€¼æ¼‚ç§»(Meanshift)</h2><p>æœ¬è´¨æ˜¯ä¸€ä¸ªè¿­ä»£çš„è¿‡ç¨‹ï¼Œèƒ½å¤Ÿåœ¨ä¸€ç»„æ•°æ®çš„å¯†åº¦åˆ†å¸ƒä¸­å¯»æ‰¾åˆ°å±€éƒ¨æå€¼ï¼Œæ¯”è¾ƒç¨³å®šï¼Œè€Œä¸”æ˜¯æ— å‚å¯†åº¦ä¼°è®¡(ä¸éœ€è¦äº‹å…ˆçŸ¥é“æ ·æœ¬æ•°æ®çš„æ¦‚ç‡å¯†åº¦åˆ†å¸ƒå‡½æ•°ï¼Œå®Œå…¨ä¾é å¯¹æ ·æœ¬ç‚¹çš„è®¡ç®—)ï¼Œè€Œä¸”åœ¨é‡‡æ ·å……åˆ†çš„æƒ…å†µä¸‹ï¼Œä¸€å®šä¼šæ”¶æ•›ï¼Œå³å¯ä»¥å¯¹æœä»ä»»æ„åˆ†å¸ƒçš„æ•°æ®è¿›è¡Œå¯†åº¦ä¼°è®¡ã€‚</p>
<h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>æœ‰ä¸€ä¸ªæ»‘åŠ¨çª—å£çš„æ€æƒ³ï¼Œå³åˆ©ç”¨å½“å‰ä¸­å¿ƒç‚¹ä¸€å®šèŒƒå›´å†…(é€šå¸¸ä¸ºçƒåŸŸ)çš„ç‚¹è¿­ä»£æ›´æ–°ä¸­å¿ƒç‚¹ï¼Œé‡å¤ç§»åŠ¨çª—å£ï¼Œç›´åˆ°æ»¡è¶³æ”¶æ•›æ¡ä»¶ã€‚ç®€å•çš„è¯´ï¼Œ<code>Meanshift</code>å°±æ˜¯æ²¿ç€å¯†åº¦ä¸Šå‡çš„æ–¹å‘å¯»æ‰¾åŒå±ä¸€ä¸ªç°‡çš„æ•°æ®ç‚¹ã€‚</p>
<p>å®šä¹‰ç‚¹$x_0$çš„$\epsilon$çƒåŸŸå¦‚ä¸‹</p>
<script type="math/tex; mode=display">
S_h(x_0) = \{ x | (x - x_0)^T (x - x_0) \leq \epsilon \}</script><p>è‹¥æœ‰$n$ä¸ªç‚¹$(x_1, â€¦, x_n)$è½åœ¨ä¸­å¿ƒç‚¹$ptCentroid$çš„é‚»åŸŸå†…ï¼Œå…¶åˆ†å¸ƒå¦‚å›¾<br><img src="/2018/11/16/Clustering/DBSCAN4.jpg" alt="DBSCAN4"></p>
<p>åˆ™åç§»å‘é‡è®¡ç®—æ–¹å¼ä¸º</p>
<script type="math/tex; mode=display">
vecShift = \frac{1}{n} \sum_{i=1}^n (x_i - ptCentroid)</script><p>ä¸­å¿ƒç‚¹æ›´æ–°å…¬å¼ä¸º</p>
<script type="math/tex; mode=display">
ptCentroid := ptCentroid + vecShift</script><blockquote>
<p>å±•å¼€åå¯å‘ç°ï¼Œå…¶æ›´æ–°å…¬å¼å³</p>
<script type="math/tex; mode=display">
vecShift
= \frac{1}{n} \sum_{i=1}^n x_i - ptCentroid</script><script type="math/tex; mode=display">
ptCentroid :=  \frac{1}{n} \sum_{i=1}^n x_i</script></blockquote>
<p><img src="/2018/11/16/Clustering/DBSCAN3.jpg" alt="DBSCAN3"></p>
<p>ä¸€ä¸ªæ»‘åŠ¨çª—å£çš„åŠ¨æ€æ›´æ–°è¿‡ç¨‹å¦‚ä¸‹å›¾<br><img src="/2018/11/16/Clustering/meanshift_example1.gif" alt="meanshift_example1"><br>åˆå§‹åŒ–å¤šä¸ªæ»‘åŠ¨çª—å£è¿›è¡Œ<code>MeanShift</code>ç®—æ³•ï¼Œå…¶æ›´æ–°è¿‡ç¨‹å¦‚ä¸‹ï¼Œå…¶ä¸­æ¯ä¸ªé»‘ç‚¹ä»£è¡¨æ»‘åŠ¨çª—å£çš„è´¨å¿ƒï¼Œæ¯ä¸ªç°ç‚¹ä»£è¡¨ä¸€ä¸ªæ•°æ®ç‚¹<br><img src="/2018/11/16/Clustering/meanshift_example2.gif" alt="meanshift_example2"></p>
<h3 id="é«˜æ–¯æƒé‡"><a href="#é«˜æ–¯æƒé‡" class="headerlink" title="é«˜æ–¯æƒé‡"></a>é«˜æ–¯æƒé‡</h3><p>åŸºæœ¬æ€æƒ³æ˜¯ï¼Œè·ç¦»å½“å‰ä¸­å¿ƒç‚¹è¿‘çš„å‘é‡å¯¹æ›´æ–°ç»“æœæƒé‡å¤§ï¼Œè€Œè¿œçš„æƒé‡å°ï¼Œå¯å‡å°è¿œç‚¹çš„å¹²æ‰°ï¼Œå¦‚ä¸‹å›¾ï¼Œ$vecShift_2$ä¸ºé«˜æ–¯æƒé‡ä¸‹çš„åç§»å‘é‡<br><img src="/2018/11/16/Clustering/DBSCAN5.jpg" alt="DBSCAN5"></p>
<p>å…¶åç§»å‘é‡è®¡ç®—æ–¹å¼ä¸º</p>
<script type="math/tex; mode=display">
vecShift = \frac{1}{n} \sum_{i=1}^n w_i Â· (x_i - ptCentroid)</script><script type="math/tex; mode=display">
w_i = \frac{\kappa(x_i - ptCentroid)}{\sum_j \kappa(x_j - ptCentroid)}</script><p>å…¶ä¸­</p>
<script type="math/tex; mode=display">
\kappa(z) = \frac{1}{\sqrt{2\pi}} \exp \left( - \frac{||z||^2}{2\sigma^2} \right)</script><p>ä¸­å¿ƒç‚¹æ›´æ–°å…¬å¼ä»ç„¶ä¸º</p>
<script type="math/tex; mode=display">
ptCentroid := ptCentroid + vecShift</script><blockquote>
<p>å±•å¼€ä¹Ÿå¯å¾—åˆ°</p>
<script type="math/tex; mode=display">
ptCentroid := \frac{\sum_{i=1}^n w_i x_i}{\sum_j w_j}</script></blockquote>
<h3 id="è®¡ç®—æ­¥éª¤-1"><a href="#è®¡ç®—æ­¥éª¤-1" class="headerlink" title="è®¡ç®—æ­¥éª¤"></a>è®¡ç®—æ­¥éª¤</h3><p>å¯¹äºç»™å®šçš„$N$ç»´æ•°æ®é›†$X = (x^{(1)}, x^{(2)}, â€¦, x^{(M)})$ï¼ŒæŒ‡å®šé‚»åŸŸå‚æ•°$\epsilon_0$ï¼Œç»ˆæ­¢æ¡ä»¶å‚æ•°$\epsilon_1$ï¼Œç°‡åˆå¹¶å‚æ•°$\epsilon_2$ï¼Œå¹¶æŒ‡å®šæ ·æœ¬è·ç¦»åº¦é‡æ–¹å¼ï¼Œç›®æ ‡ä¸ºå°†å…¶åˆ’åˆ†ä¸º$K$ä¸ªç°‡ã€‚</p>
<ol>
<li>åˆå§‹åŒ–ï¼š<ul>
<li>åœ¨æ ·æœ¬é›†ä¸­éšæœºé€‰æ‹©$K_0(K_0 \gg K)$ä¸ªæ ·æœ¬ä½œä¸ºåˆå§‹ä¸­å¿ƒç‚¹ï¼Œä»¥é‚»åŸŸå¤§å°ä¸º$\epsilon_0$å»ºç«‹æ»‘åŠ¨çª—å£ï¼›</li>
<li>å„ä¸ªæ ·æœ¬åˆå§‹åŒ–ä¸€ä¸ªæ ‡è®°å‘é‡ï¼Œç”¨äºè®°å½•è¢«å„ç±»åˆ«è®¿é—®çš„æ¬¡æ•°ï¼›</li>
</ul>
</li>
<li>ä»¥å•ä¸ªæ»‘åŠ¨çª—å£åˆ†æï¼Œè®°å…¶ä¸­å¿ƒç‚¹ä¸º$ptCentroid$ï¼Œæ‰¾åˆ°æ»‘åŠ¨çª—å£å†…çš„æ‰€æœ‰ç‚¹ï¼Œè®°ä½œé›†åˆ$M$ï¼Œè®¤ä¸ºè¿™äº›ç‚¹å±äºè¯¥æ»‘åŠ¨çª—å£æ‰€å±çš„ç°‡ç±»åˆ«ï¼ŒåŒæ—¶ï¼Œè¿™äº›ç‚¹è¢«è¯¥ç°‡è®¿é—®çš„æ¬¡æ•°$+1$ï¼›</li>
<li>ä»¥$ptCentroid$ä¸ºä¸­å¿ƒï¼Œè®¡ç®—å…¶åˆ°é›†åˆ$M$ä¸­å„ä¸ªå…ƒç´ çš„å‘é‡ï¼Œä»¥è¿™äº›å‘é‡è®¡ç®—å¾—åˆ°åç§»å‘é‡$vecShift$ï¼›</li>
<li>æ›´æ–°ä¸­å¿ƒç‚¹ï¼š$ptCentroid = ptCentroid + vecShift$ï¼Œå³æ»‘åŠ¨çª—å£æ²¿ç€$vecShift$æ–¹å‘ç§»åŠ¨ï¼Œè·ç¦»ä¸º$||vecShift||$ï¼›</li>
<li>é‡å¤æ­¥éª¤$2-4$ï¼Œç›´åˆ°$||vecShift||&lt;\epsilon_1$ï¼Œä¿å­˜å½“å‰ä¸­å¿ƒç‚¹ï¼›</li>
<li>å¦‚æœæ”¶æ•›æ—¶å½“å‰ç°‡$ptCentroid$ä¸å…¶å®ƒå·²ç»å­˜åœ¨çš„ç°‡çš„ä¸­å¿ƒçš„è·ç¦»å°äºé˜ˆå€¼$\epsilon_2$ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªç°‡åˆå¹¶ã€‚å¦åˆ™ï¼ŒæŠŠå½“å‰ç°‡ä½œä¸ºæ–°çš„ç°‡ç±»ï¼Œå¢åŠ $1$ç±»ï¼›</li>
<li>é‡å¤è¿­ä»£ç›´åˆ°æ‰€æœ‰çš„ç‚¹éƒ½è¢«æ ‡è®°è®¿é—®ï¼›</li>
<li>æ ¹æ®æ¯ä¸ªæ ·æœ¬è¢«å„ç°‡çš„è®¿é—®é¢‘ç‡ï¼Œå–è®¿é—®é¢‘ç‡æœ€å¤§çš„é‚£ä¸ªç°‡ç±»åˆ«ä½œä¸ºå½“å‰ç‚¹é›†çš„æ‰€å±ç±»ã€‚</li>
</ol>
<blockquote>
<p>å³ä¸åŒç±»å‹çš„æ»‘çª—æ²¿ç€å¯†åº¦ä¸Šå‡çš„æ–¹å‘è¿›è¡Œç§»åŠ¨ï¼Œå¯¹å„æ ·æœ¬ç‚¹è¿›è¡Œæ ‡è®°ï¼Œæœ€åå°†æ ·æœ¬åˆ’åˆ†ä¸ºæ ‡è®°æœ€å¤šçš„ç±»åˆ«ï¼›å½“ä¸¤ç±»éå¸¸æ¥è¿‘æ—¶ï¼Œåˆå¹¶ä¸ºä¸€ç±»ã€‚</p>
</blockquote>
<h3 id="ä»£ç -1"><a href="#ä»£ç -1" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p><a href="https://github.com/isLouisHsu/Python-Examples-for-Pattern-Recognition-Course/blob/master/examples/p71_meanshift.py" target="_blank" rel="noopener">@Github: MeanShift</a></p>
<p>å…ˆå®šä¹‰äº†çª—æ ¼å¯¹è±¡<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">class SlidingWindow():</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Attributes:</span><br><span class="line">        centroid: &#123;ndarray(n_features,)&#125;</span><br><span class="line">        epsilon: &#123;float&#125; æ»‘åŠ¨çª—æ ¼å¤§å°ï¼Œä¸ºåŠå¾„çš„å¹³æ–¹</span><br><span class="line">        sigma: &#123;float&#125; é«˜æ–¯æ ¸å‡½æ•°çš„å‚æ•°</span><br><span class="line">        label: &#123;int&#125; è¯¥çª—æ ¼çš„æ ‡è®°</span><br><span class="line">        X: &#123;ndarray(n_samples, n_features)&#125;</span><br><span class="line">        containIdx: &#123;ndarray(n_contain,)&#125; çª—æ ¼å†…åŒ…å«ç‚¹çš„ç´¢å¼•</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    def __init__(self, centroid, epsilon, sigma, label, X):</span><br><span class="line">        self.centroid = centroid</span><br><span class="line">        self.epsilon = epsilon</span><br><span class="line">        self.sigma = sigma</span><br><span class="line">        self.label = label</span><br><span class="line">        self.containIdx = self.updateContain(X)</span><br><span class="line">    def k(self, z):</span><br><span class="line">        &quot;&quot;&quot; é«˜æ–¯æ ¸å‡½æ•°</span><br><span class="line">        Args:</span><br><span class="line">            z: &#123;ndarray(n_features,)&#125;</span><br><span class="line">        Notes:</span><br><span class="line">            - \kappa(z) = \frac&#123;1&#125;&#123;\sqrt&#123;2\pi&#125;&#125; \exp \left( - \frac&#123;||z||^2&#125;&#123;2\sigma^2&#125; \right)</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        norm = np.linalg.norm(z)</span><br><span class="line">        return np.exp(- 0.5 * (norm / self.sigma)**2) / np.sqrt(2*np.pi)</span><br><span class="line">    def step(self, X):</span><br><span class="line">        &quot;&quot;&quot; æ›´æ–°æ»‘åŠ¨çª—æ ¼çš„ä¸­å¿ƒç‚¹å’Œæ‰€åŒ…å«ç‚¹</span><br><span class="line">        Returns: &#123;float&#125;</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        dshift = self.shift(X)</span><br><span class="line">        self.containIdx = self.updateContain(X)</span><br><span class="line">        return dshift</span><br><span class="line">    def shift(self, X):</span><br><span class="line">        &quot;&quot;&quot; ç§»åŠ¨çª—æ ¼</span><br><span class="line">        Args:</span><br><span class="line">            vecShift: &#123;ndarray(n_features,)&#125;</span><br><span class="line">        Returns:</span><br><span class="line">            dshift: &#123;float&#125; ç§»åŠ¨çš„è·ç¦»</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        (n_samples, n_features) = X.shape</span><br><span class="line">        n_contain = self.containIdx.shape[0]</span><br><span class="line">        contain_weighted_sum = np.zeros(shape=(n_features, ))</span><br><span class="line">        weight_sum = 0</span><br><span class="line">        # æŒ‰åŒ…å«çš„ç‚¹è¿›è¡Œç§»åŠ¨</span><br><span class="line">        for i_contain in range(n_contain):</span><br><span class="line">            vector = X[self.containIdx[i_contain]] - self.centroid</span><br><span class="line">            weight = self.k(vector)</span><br><span class="line">            contain_weighted_sum += weight*X[self.containIdx[i_contain]]</span><br><span class="line">            weight_sum += weight</span><br><span class="line">        centroid = contain_weighted_sum / weight_sum	 </span><br><span class="line">        # è®¡ç®—ç§»åŠ¨çš„è·ç¦»   </span><br><span class="line">        dshift = np.linalg.norm(self.centroid - centroid)</span><br><span class="line">        self.centroid = centroid</span><br><span class="line">        return dshift</span><br><span class="line">    def updateContain(self, X):</span><br><span class="line">        &quot;&quot;&quot; æ›´æ–°çª—æ ¼å†…çš„ç‚¹ç´¢å¼•</span><br><span class="line">        Args:</span><br><span class="line">            X: &#123;ndarray(n_samples, n_features)&#125;</span><br><span class="line">        Notes:</span><br><span class="line">            - ç”¨æ¬§å¼è·ç¦»ä½œä¸ºåº¦é‡</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        d = lambda x_i, x_j: np.linalg.norm(x_i - x_j)</span><br><span class="line">        n_samples = X.shape[0]</span><br><span class="line">        containIdx = np.array([], dtype=&apos;int&apos;)</span><br><span class="line">        for i_samples in range(n_samples):</span><br><span class="line">            if d(X[i_samples], self.centroid) &lt; self.epsilon:</span><br><span class="line">                containIdx = np.r_[containIdx, i_samples]</span><br><span class="line">        return containIdx</span><br></pre></td></tr></table></figure></p>
<p>èšç±»ç®—æ³•å¦‚ä¸‹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">class MeanShift():</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Attributes:</span><br><span class="line">        n_clusters: &#123;int&#125; åˆ’åˆ†ç°‡çš„ä¸ªæ•°</span><br><span class="line">        n_windows: &#123;int&#125; æ»‘åŠ¨çª—æ ¼çš„ä¸ªæ•°</span><br><span class="line">        epsilon: &#123;float&#125; æ»‘åŠ¨çª—æ ¼çš„å¤§å°</span><br><span class="line">        sigma: &#123;float&#125; &#123;float&#125; é«˜æ–¯æ ¸å‚æ•°</span><br><span class="line">        thresh: &#123;float&#125; è‹¥ä¸¤ä¸ªçª—æ ¼ä¸­å¿ƒè·ç¦»å°äºthreshï¼Œåˆ™åˆå¹¶ä¸¤ç±»ç°‡</span><br><span class="line">        min_move: &#123;float&#125; ç»ˆæ­¢æ¡ä»¶</span><br><span class="line">        windows: &#123;list[class SlidingWindow()]&#125;</span><br><span class="line">    Note:</span><br><span class="line">        - å‡è®¾æ‰€æœ‰ç‚¹å‡è¢«çª—æ ¼åˆ’è¿‡</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    </span><br><span class="line">    def __init__(self, n_clusters, n_windows=-1, epsilon=0.5, sigma=2, thresh=1e-2, min_move=1e-3):</span><br><span class="line">        self.n_clusters = n_clusters</span><br><span class="line">        self.n_windows = 5*n_clusters if (n_windows == -1) else n_windows</span><br><span class="line">        self.epsilon = epsilon</span><br><span class="line">        self.sigma = sigma</span><br><span class="line">        self.thresh = thresh</span><br><span class="line">        self.min_move = min_move</span><br><span class="line">        self.windows = []</span><br><span class="line">        self.centroids = None</span><br><span class="line">    def fit(self, X):</span><br><span class="line">        (n_samples, n_features) = X.shape</span><br><span class="line">        # åˆ›å»ºçª—æ ¼</span><br><span class="line">        for i_windows in range(self.n_windows):</span><br><span class="line">            idx = np.random.randint(n_samples)</span><br><span class="line">            window = SlidingWindow(X[idx], self.epsilon,</span><br><span class="line">                            self.sigma, i_windows, X)</span><br><span class="line">            # å°†å„çª—æ ¼åŒ…å«çš„ç‚¹æ ‡è®°</span><br><span class="line">            n_contain = window.containIdx.shape[0]</span><br><span class="line">            self.windows.append(window)</span><br><span class="line"></span><br><span class="line">        dshift = float(&apos;inf&apos;)   # åˆå§‹åŒ–ä¸ºæ— ç©·å¤§</span><br><span class="line">        plt.figure(); plt.ion()</span><br><span class="line">        while dshift &gt; self.min_move:</span><br><span class="line">            # ------ åšå›¾æ˜¾ç¤º ------</span><br><span class="line">            plt.cla()</span><br><span class="line">            plt.scatter(X[:, 0], X[:, 1], c=&apos;b&apos;)</span><br><span class="line">            for i_windows in range(self.n_windows):</span><br><span class="line">                centroid = self.windows[i_windows].centroid</span><br><span class="line">                plt.scatter(centroid[0], centroid[1], c=&apos;r&apos;)</span><br><span class="line">            plt.pause(0.5)</span><br><span class="line">            # ---------------------</span><br><span class="line">            dshift = self.step(X)</span><br><span class="line">        plt.ioff()</span><br><span class="line">        </span><br><span class="line">        # åˆå¹¶çª—æ ¼</span><br><span class="line">        dists = np.zeros(shape=(self.n_windows, self.n_windows))</span><br><span class="line">        for i_windows in range(self.n_windows):</span><br><span class="line">            for j_windows in range(i_windows):</span><br><span class="line">                centroid_i = self.windows[i_windows].centroid</span><br><span class="line">                centroid_j = self.windows[j_windows].centroid</span><br><span class="line">                dists[i_windows, j_windows] = np.linalg.norm(centroid_i-centroid_j)</span><br><span class="line">                dists[j_windows, i_windows] = dists[i_windows, j_windows]</span><br><span class="line">        </span><br><span class="line">        # è·å¾—è·ç¦»ç›¸è¿‘ç´¢å¼•</span><br><span class="line">        index = np.where(dists&lt;self.thresh)</span><br><span class="line">        # ç”¨äºæ ‡è®°ç±»åˆ«</span><br><span class="line">        winlabel = np.zeros(shape=(self.n_windows,), dtype=&apos;int&apos;)</span><br><span class="line">        label = 1; winlabel[0] = label</span><br><span class="line">        for i_windows in range(self.n_windows):</span><br><span class="line">            idx_row = index[0][i_windows]</span><br><span class="line">            idx_col = index[1][i_windows]</span><br><span class="line">            # è‹¥å…¶ä¸­ä¸€ä¸ªç‚¹è¢«æ ‡è®°ï¼Œåˆ™å°†ä»¤ä¸€ä¸ªç‚¹å¹¶å…¥è¯¥ç±»</span><br><span class="line">            if winlabel[idx_row]!=0:</span><br><span class="line">                winlabel[idx_col] = winlabel[idx_row]</span><br><span class="line">            elif winlabel[idx_col]!=0:</span><br><span class="line">                winlabel[idx_row] = winlabel[idx_col]</span><br><span class="line">            # å¦åˆ™æ–°åˆ›å»ºç±»åˆ«</span><br><span class="line">            else:</span><br><span class="line">                label += 1</span><br><span class="line">                winlabel[idx_row] = label</span><br><span class="line">                winlabel[idx_col] = label</span><br><span class="line">        </span><br><span class="line">        # å°†æ ‡ç­¾ä¸€æ ·çš„çª—æ ¼åˆå¹¶</span><br><span class="line">        labels = list(set(winlabel))                            # å»é‡åçš„æ ‡ç­¾</span><br><span class="line">        n_labels = len(labels)                                  # æ ‡ç­¾ç§ç±»æ•°</span><br><span class="line">        self.centroids = np.zeros(shape=(n_labels, n_features)) # è®°å½•æœ€ç»ˆèšç±»ä¸­å¿ƒ</span><br><span class="line">        for i_labels in range(n_labels):</span><br><span class="line">            cnt = 0</span><br><span class="line">            for i_windows in range(self.n_windows):</span><br><span class="line">                if winlabel[i_windows] == labels[i_labels]:</span><br><span class="line">                    self.centroids[i_labels] += self.windows[i_windows].centroid</span><br><span class="line">                    cnt += 1</span><br><span class="line">            self.centroids[i_labels] /= cnt	                    # å–åŒç±»çª—æ ¼ä¸­å¿ƒç‚¹çš„å‡å€¼</span><br><span class="line">        return self.centroids</span><br><span class="line"></span><br><span class="line">    def step(self, X):</span><br><span class="line">        &quot;&quot;&quot; update all sliding windows</span><br><span class="line">        Returns:</span><br><span class="line">            dshift: \sum_i^&#123;n_windows&#125; dshift_&#123;i&#125;</span><br><span class="line">        &quot;&quot;&quot; </span><br><span class="line">        dshift = 0</span><br><span class="line">        for i_windows in range(self.n_windows):</span><br><span class="line">            dshift += self.windows[i_windows].step(X)</span><br><span class="line">            # label the points</span><br><span class="line">            n_contain = self.windows[i_windows].containIdx.shape[0]</span><br><span class="line">        return dshift</span><br><span class="line">    def predict(self, X):</span><br><span class="line">        &quot;&quot;&quot; ç®€å•çš„ç”¨è¿‘é‚»çš„æ–¹æ³•æ±‚</span><br><span class="line">        &quot;&quot;&quot;</span><br><span class="line">        (n_samples, n_features) = X.shape</span><br><span class="line">        dists = np.zeros(shape=(n_samples, self.n_clusters))</span><br><span class="line">        for i_samples in range(n_samples):</span><br><span class="line">            for i_clusters in range(self.n_clusters):</span><br><span class="line">                dists[i_samples, i_clusters] = np.linalg.norm(X[i_samples]-self.centroids[i_clusters])</span><br><span class="line">        return np.argmin(dists, axis=1)</span><br></pre></td></tr></table></figure></p>
<h2 id="è°±èšç±»-Spectral-Clustering"><a href="#è°±èšç±»-Spectral-Clustering" class="headerlink" title="è°±èšç±»(Spectral Clustering)"></a>è°±èšç±»(Spectral Clustering)</h2><p>è°±èšç±»æ˜¯ä»å›¾è®ºä¸­æ¼”åŒ–å‡ºæ¥çš„ç®—æ³•ï¼Œåæ¥åœ¨èšç±»ä¸­å¾—åˆ°äº†å¹¿æ³›çš„åº”ç”¨ï¼Œæ¯”èµ·ä¼ ç»Ÿçš„<code>K-Means</code>ç®—æ³•ï¼Œè°±èšç±»å¯¹æ•°æ®åˆ†å¸ƒçš„é€‚åº”æ€§æ›´å¼ºï¼Œèšç±»æ•ˆæœä¹Ÿå¾ˆä¼˜ç§€ï¼ŒåŒæ—¶èšç±»çš„è®¡ç®—é‡ä¹Ÿå°å¾ˆå¤šã€‚</p>
<h3 id="åŸç†-2"><a href="#åŸç†-2" class="headerlink" title="åŸç†"></a>åŸç†</h3><blockquote>
<p><a href="https://www.cnblogs.com/pinard/p/6221564.html" target="_blank" rel="noopener">è°±èšç±»ï¼ˆspectral clusteringï¼‰åŸç†æ€»ç»“ - åˆ˜å»ºå¹³Pinard - åšå®¢å›­ </a></p>
</blockquote>
<h4 id="æ— å‘æƒé‡å›¾"><a href="#æ— å‘æƒé‡å›¾" class="headerlink" title="æ— å‘æƒé‡å›¾"></a>æ— å‘æƒé‡å›¾</h4><p>æˆ‘ä»¬ç”¨ç‚¹çš„é›†åˆ$V$å’Œè¾¹çš„é›†åˆ$E$æè¿°ä¸€ä¸ªå›¾ï¼Œå³$G(V, E)$ï¼Œå…¶ä¸­$V$å³æ•°æ®é›†ä¸­çš„ç‚¹</p>
<script type="math/tex; mode=display">
V = [v_1, v_2, ..., v_n]</script><p>è€Œç‚¹$v_i, v_j$é—´è¿æ¥æƒå€¼$w_{ij}$ç»„æˆé‚»æ¥çŸ©é˜µ$W$ï¼Œç”±äºä¸ºæ— å‘å›¾ï¼Œæ•…æ»¡è¶³$w_{ij}=w_{ji}$</p>
<script type="math/tex; mode=display">
W = \left[
    \begin{matrix}
        w_{11} & ... & w_{1n} \\
        ... & ... & ... \\
        w_{n1} & ... & w_{nn} \\
    \end{matrix}
    \right]</script><p>å¯¹äºå›¾ä¸­çš„ä»»æ„ä¸€ä¸ªç‚¹$v_i$ï¼Œå®šä¹‰å…¶åº¦$d_i$ä¸º</p>
<script type="math/tex; mode=display">
d_i = \sum_{j=1}^n w_{ij}</script><p>åˆ™æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ä¸ªåº¦çŸ©é˜µ$D=diag(d_1, â€¦, d_n)$</p>
<script type="math/tex; mode=display">
D = \left[
        \begin{matrix}
            d_1 & & \\
            & ... & \\
             & & d_n\\
        \end{matrix}
    \right]</script><p>é™¤æ­¤ä¹‹å¤–ï¼Œå¯¹äº$V$ä¸­å­é›†$V_{sub} \subset V$ï¼Œå®šä¹‰å­é›†$V_{sub}$ç‚¹çš„ä¸ªæ•°ä¸º</p>
<script type="math/tex; mode=display">
|V_{sub}| := n_{sub}</script><p>å¦å¤–ï¼Œå®šä¹‰è¯¥å­é›†ä¸­ç‚¹çš„åº¦ä¹‹å’Œä¸º</p>
<script type="math/tex; mode=display">
vol(V_{sub}) = \sum_{i \in V_{sub}} d_i</script><h4 id="ç›¸ä¼¼çŸ©é˜µ"><a href="#ç›¸ä¼¼çŸ©é˜µ" class="headerlink" title="ç›¸ä¼¼çŸ©é˜µ"></a>ç›¸ä¼¼çŸ©é˜µ</h4><p>ä¸Šé¢è®²åˆ°çš„é‚»æ¥çŸ©é˜µ$W$å¯ä»¥æŒ‡å®šæƒå€¼ï¼Œä½†å¯¹äºæ•°æ®é‡åºå¤§çš„æ•°æ®é›†ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯ä¸€ä¸ª$wise$çš„é€‰æ‹©ã€‚æˆ‘ä»¬å¯ä»¥ç”¨ç›¸ä¼¼çŸ©é˜µ$S$æ¥è·å¾—é‚»æ¥çŸ©é˜µ$W$ï¼ŒåŸºæœ¬æ€æƒ³æ˜¯ï¼Œè·ç¦»è¾ƒè¿œçš„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è¾¹æƒé‡å€¼è¾ƒä½ï¼Œè€Œè·ç¦»è¾ƒè¿‘çš„ä¸¤ä¸ªç‚¹ä¹‹é—´çš„è¾¹æƒé‡å€¼è¾ƒé«˜ã€‚</p>
<p>æ„å»ºé‚»æ¥çŸ©é˜µ$W$çš„æ–¹æ³•æœ‰ä¸‰ç±»ï¼š$\epsilon$-é‚»è¿‘æ³•ï¼Œ$K$é‚»è¿‘æ³•å’Œå…¨è¿æ¥æ³•ï¼Œå®šä¹‰è·ç¦»</p>
<script type="math/tex; mode=display">
d_{ij} = ||x^{(i)} - x^{(j)}||_2^2</script><ul>
<li><p>$\epsilon$-é‚»è¿‘æ³•<br>  è®¾ç½®è·ç¦»é˜ˆå€¼$\epsilon$ï¼Œç”¨æ¬§å¼è·ç¦»åº¦é‡ä¸¤ç‚¹çš„è·ç¦»$d_{ij}$ï¼Œç„¶åé€šè¿‡ä¸‹å¼ç¡®å®šé‚»æ¥æƒå€¼$w_{ij}$</p>
<script type="math/tex; mode=display">
  w_{ij} = \begin{cases}
      0 & d_{ij} > \epsilon \\
      \epsilon & otherwise
  \end{cases}</script><blockquote>
<p>ä¸¤ç‚¹é—´çš„æƒé‡è¦ä¸å°±æ˜¯$\epsilon$ï¼Œè¦ä¸å°±æ˜¯0ï¼Œè·ç¦»è¿œè¿‘åº¦é‡å¾ˆä¸ç²¾ç¡®ï¼Œå› æ­¤åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬å¾ˆå°‘ä½¿ç”¨$\epsilon$-é‚»è¿‘æ³•ã€‚</p>
</blockquote>
</li>
<li><p>$K$é‚»è¿‘æ³•</p>
<ul>
<li><p>ç¬¬ä¸€ç§<br>  åªè¦ä¸€ä¸ªç‚¹åœ¨å¦ä¸€ä¸ªç‚¹çš„$K$è¿‘é‚»ä¸­ï¼Œåˆ™ä¿ç•™$d_{ij}$</p>
<script type="math/tex; mode=display">
  w_{ij} = \begin{cases}
      \exp \left( -\frac{d_{ij}}{2\sigma^2} \right) & x^{(i)} \in KNN(x^{(j)})ã€€orã€€x^{(j)} \in KNN(x^{(i)}) \\
      0 & otherwise
  \end{cases}</script></li>
<li><p>ç¬¬äºŒç§<br>  äº’ä¸º$K$è¿‘é‚»æ—¶ä¿ç•™$d_{ij}$</p>
<script type="math/tex; mode=display">
  w_{ij} = \begin{cases}
      \exp \left( -\frac{d_{ij}}{2\sigma^2} \right) & x^{(i)} \in KNN(x^{(j)})ã€€andã€€x^{(j)} \in KNN(x^{(i)}) \\
      0 & otherwise
  \end{cases}</script></li>
</ul>
</li>
<li><p>å…¨è¿æ¥æ³•<br>  å¯ä»¥é€‰æ‹©ä¸åŒçš„æ ¸å‡½æ•°æ¥å®šä¹‰è¾¹æƒé‡ï¼Œå¸¸ç”¨çš„æœ‰å¤šé¡¹å¼æ ¸å‡½æ•°ï¼Œé«˜æ–¯æ ¸å‡½æ•°å’Œ<code>Sigmoid</code>æ ¸å‡½æ•°ã€‚æœ€å¸¸ç”¨çš„æ˜¯é«˜æ–¯æ ¸å‡½æ•°<code>RBF</code>ï¼Œæ­¤æ—¶ç›¸ä¼¼çŸ©é˜µå’Œé‚»æ¥çŸ©é˜µç›¸åŒ</p>
<script type="math/tex; mode=display">
  w_{ij} = \exp \left( -\frac{d_{ij}}{2\sigma^2} \right)</script></li>
</ul>
<h4 id="æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ-Graph-Laplacians"><a href="#æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ-Graph-Laplacians" class="headerlink" title="æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ(Graph Laplacians)"></a>æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ(Graph Laplacians)</h4><p>å®šä¹‰</p>
<script type="math/tex; mode=display">
L = D - W</script><p>æ­£åˆ™åŒ–çš„æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µä¸º</p>
<script type="math/tex; mode=display">
L = D^{-1} (D - W)</script><p>å…·æœ‰çš„æ€§è´¨å¦‚ä¸‹</p>
<ol>
<li>$L^T = L$</li>
<li>å…¶ç‰¹å¾å€¼å‡ä¸ºå®æ•°ï¼Œå³$\lambda_i \in \mathbb{R}$</li>
<li>æ­£å®šæ€§ï¼š$\lambda_i \geq 0$</li>
<li><p>å¯¹äºä»»æ„å‘é‡$x$ï¼Œéƒ½æœ‰</p>
<script type="math/tex; mode=display">
x^T L x = \frac{1}{2} \sum_{i,j} w_{ij} (x_i - x_j)^2</script><blockquote>
<p>è¯æ˜ï¼š</p>
<script type="math/tex; mode=display">
x^T L x = x^T D x - x^T W x = \sum_i d_i > x_i^2 - \sum_{ij} w_{ij} x_i x_j</script><script type="math/tex; mode=display">
= \frac{1}{2} \left[ \sum_i d_i x_i^2 - > 2\sum_{ij} w_{ij} x_i x_j + \sum_j d_j x_j^2 \right]</script><p>å…¶ä¸­$ d_i = \sum_j w_{ij} $ï¼Œæ‰€ä»¥</p>
<script type="math/tex; mode=display">
x^T L x = \frac{1}{2} \sum_{i,j} w_{ij} (x_i - x_j)^2</script></blockquote>
</li>
</ol>
<h4 id="æ— å‘å›¾çš„åˆ‡å›¾"><a href="#æ— å‘å›¾çš„åˆ‡å›¾" class="headerlink" title="æ— å‘å›¾çš„åˆ‡å›¾"></a>æ— å‘å›¾çš„åˆ‡å›¾</h4><h5 id="cut"><a href="#cut" class="headerlink" title="cut"></a>cut</h5><p>æˆ‘ä»¬å¸Œæœ›æŠŠä¸€å¼ æ— å‘å›¾$G(V, E)$æŒ‰ä¸€å®šæ–¹æ³•åˆ‡æˆå¤šä¸ªå­å›¾ï¼Œå„ä¸ªå­å›¾é—´æ— è¿æ¥ï¼Œæ¯ä¸ªå­å›¾çš„ç‚¹é›†ä¸º$V_1, â€¦, V_K$ï¼Œæ»¡è¶³</p>
<ul>
<li>$\bigcup_{k=1}^K V_k = V$</li>
<li>$V_i \cap V_j = \emptyset$</li>
</ul>
<p>å®šä¹‰ä¸¤ä¸ªå­å›¾ç‚¹é›†åˆ$A, B$ä¹‹é—´çš„åˆ‡å›¾æƒé‡ä¸º</p>
<script type="math/tex; mode=display">
W(A, B) = \sum_{i \in A, j \in B} w_{ij}</script><blockquote>
<p>å…±æœ‰$n_A Ã— n_B$ä¸ªæƒå€¼ä½œç´¯åŠ </p>
</blockquote>
<p>é‚£ä¹ˆå¯¹äº$K$ä¸ªå­å›¾ç‚¹çš„é›†åˆ$V_1, â€¦, V_K$ï¼Œå®šä¹‰åˆ‡å›¾ä¸º</p>
<script type="math/tex; mode=display">
cut(V_1, ..., V_K) = \frac{1}{2} \sum_{i=1}^K cut(V_i, \overline{V_i})</script><script type="math/tex; mode=display">
cut(V_i, \overline{V_i}) = W (V_i, \overline{V_i})</script><p>å…¶ä¸­$\overline{V_i}$è¡¨ç¤º$V_i$çš„è¡¥é›†ï¼Œæˆ–è€…</p>
<script type="math/tex; mode=display">
\overline{V_i} = \bigcup_{k \neq i} V_k</script><p>é€šè¿‡æœ€å°åŒ–$cut(V_1, â€¦, V_K)$ä½¿å­å›¾å†…æƒé‡å’Œå¤§ï¼Œè€Œå­å›¾é—´æƒé‡å’Œå°ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•å­˜åœ¨é—®é¢˜ï¼Œå¦‚ä¸‹å›¾<br><img src="/2018/11/16/Clustering/cut.jpg" alt="cut"></p>
<p>é€‰æ‹©ä¸€ä¸ªæƒé‡æœ€å°çš„è¾¹ç¼˜çš„<strong>ç‚¹</strong>ï¼Œæ¯”å¦‚$C$å’Œ$H$ä¹‹é—´è¿›è¡Œ$cut$ï¼Œè¿™æ ·å¯ä»¥æœ€å°åŒ–$cut(V_1, â€¦, V_K)$ï¼Œä½†æ˜¯å´ä¸æ˜¯æœ€ä¼˜çš„åˆ‡å›¾ã€‚</p>
<p>ä¸ºè§£å†³ä¸Šè¿°é—®é¢˜ï¼Œéœ€è¦å¯¹æ¯ä¸ªå­å›¾çš„è§„æ¨¡åšå‡ºé™å®šï¼Œä»¥ä¸‹ä»‹ç»ä¸¤ç§åˆ‡å›¾æ–¹å¼ã€‚</p>
<h5 id="Ratio-Cut"><a href="#Ratio-Cut" class="headerlink" title="Ratio Cut"></a>Ratio Cut</h5><p>ä¸ä»…è€ƒè™‘æœ€å°åŒ–$cut(V_1, â€¦, V_K)$ï¼Œè€Œä¸”æœ€å¤§åŒ–æ¯ä¸ªå­å›¾çš„ç‚¹ä¸ªæ•°ï¼Œå³</p>
<script type="math/tex; mode=display">
RatioCut(V_1, ..., V_K) = \frac{1}{2} \sum_k \frac{cut(V_i, \overline{V_i})}{|V_k|}</script><script type="math/tex; mode=display">
cut(V_i, \overline{V_i}) = W (V_i, \overline{V_i})</script><blockquote>
<ul>
<li>$W(V_k, \overline{V_k}) = \sum_{i \in V_k, j \in \overline{V_k}} w_{ij}$</li>
<li>$|V_k| = n_k$</li>
</ul>
</blockquote>
<p>å¦‚æœæŒ‰ç…§éå†çš„æ–¹æ³•æ±‚è§£ï¼Œç”±å‰é¢åˆ†æï¼Œ$W(V_k, \overline{V_k})$éœ€è®¡ç®—$n_{V_k} Ã— n_{\overline{V_k}}$æ¬¡ç´¯åŠ ï¼Œè®¡ç®—é‡åºå¤§ï¼Œé‚£ä¹ˆå¦‚ä½•æ±‚è§£å‘¢ï¼Ÿ</p>
<p>å®šä¹‰æŒ‡ç¤ºå‘é‡$h_k$ï¼Œå…¶æ„æˆçŸ©é˜µ$H$</p>
<script type="math/tex; mode=display">
H = [ h_1, ..., h_k, ..., h_K]</script><p>å…¶ä¸­</p>
<script type="math/tex; mode=display">
h_k = \left[h_{k1}, h_{k2}, , ..., h_{kM} \right]^T</script><script type="math/tex; mode=display">
h_{ki} = \begin{cases}
    \frac{1}{\sqrt{|V_k|}} & x^{(i)}\in V_k \\
    0 & otherwise
\end{cases}</script><blockquote>
<p>$h_k$ä¸ºå•ä½å‘é‡ï¼Œä¸”ä¸¤ä¸¤æ­£äº¤</p>
<script type="math/tex; mode=display">
h_i^T h_j = 
      \begin{cases}
          \sum_{|V_i|} \frac{1}{|V_i|} = |V_i| Â· \frac{1}{|V_i|} = 1 & i = j \\
          0 & i \neq j
      \end{cases}</script></blockquote>
<p>é‚£ä¹ˆç”±æ‹‰å¼çŸ©é˜µæ€§è´¨$4$</p>
<script type="math/tex; mode=display">
h_k^T L h_k = \frac{1}{2} \sum_{i,j} w_{ij} (h_{ki} - h_{kj})^2</script><script type="math/tex; mode=display">
= \frac{1}{2} 
    [
        \sum_{i \in V_k, j \in V_k} w_{ij} (h_{ki} - h_{kj})^2 + 
        \sum_{i \notin V_k, j \in V_k} w_{ij} (h_{ki} - h_{kj})^2 +</script><script type="math/tex; mode=display">
        \sum_{i \in V_k, j \notin V_k} w_{ij} (h_{ki} - h_{kj})^2 + 
        \sum_{i \notin V_k, j \notin V_k} w_{ij} (h_{ki} - h_{kj})^2
    ]</script><script type="math/tex; mode=display">
= \frac{1}{2}
    [
        \sum_{i \in V_k, j \in V_k} w_{ij} (\frac{1}{\sqrt{|V_k|}} - \frac{1}{\sqrt{|V_k|}})^2 + 
        \sum_{i \notin V_k, j \in V_k} w_{ij} (0 - \frac{1}{\sqrt{|V_k|}})^2 +</script><script type="math/tex; mode=display">
        \sum_{i \in V_k, j \notin V_k} w_{ij} (\frac{1}{\sqrt{|V_k|}} - 0)^2 +
        \sum_{i \notin V_k, j \notin V_k} w_{ij} (0 - 0)^2
    ]</script><script type="math/tex; mode=display">
= \frac{1}{2}
    [
        \sum_{i \notin V_k, j \in V_k} w_{ij} \frac{1}{|V_k|} +
        \sum_{i \in V_k, j \notin V_k} w_{ij} \frac{1}{|V_k|}
    ]</script><blockquote>
<script type="math/tex; mode=display">cut(V_i, \overline{V_i}) = W (V_i, \overline{V_i}) = \sum_{i \in V_k, j \in \overline{V_k}} w_{ij}</script></blockquote>
<script type="math/tex; mode=display">
h_k^T L h_k = \frac{1}{2} [\frac{1}{|V_k|} cut(V_k, \overline{V_k}) + \frac{1}{|V_k|} cut(V_k, \overline{V_k})]</script><script type="math/tex; mode=display">
= \frac{1}{|V_k|} cut(V_k, \overline{V_k})</script><p>æ¨åˆ°è¿™é‡Œå°±èƒ½ç†è§£ä¸ºä»€ä¹ˆè¦å®šä¹‰$h_k$äº†</p>
<script type="math/tex; mode=display">
RatioCut(V_1, ..., V_K)
= \frac{1}{2} \sum_k h_k^T L h_k</script><p>å¹¶ä¸”</p>
<script type="math/tex; mode=display">
h_k^T L h_k = tr(H^T L H)</script><blockquote>
<script type="math/tex; mode=display">
H^T L H 
= \left[
      \begin{matrix}
          â€” & h_1^T & â€” \\
           & ... &  \\
          â€” & h_K^T & â€” \\
      \end{matrix}
\right]
L
\left[  
        \begin{matrix}
            | & & | \\
            h_1 & ... & h_K \\
            | & & |
        \end{matrix}
    \right]</script><script type="math/tex; mode=display">
= \left[
      \begin{matrix}
          h_1^T L h_1 & ... & h_1^T L h_K \\
          ... & ... & ... \\
          h_K^T L h_K & ... & h_K^T L h_K \\
      \end{matrix}
\right]</script></blockquote>
<p>æ‰€ä»¥æœ€ç»ˆä¼˜åŒ–ç›®æ ‡ä¸º</p>
<script type="math/tex; mode=display">
\min_H tr(H^T L H)</script><script type="math/tex; mode=display">
s.t.ã€€H^T H = I</script><blockquote>
<script type="math/tex; mode=display">
H^T H = \left[
      \begin{matrix}
          h_1^T h_1 & ... & h_1^T h_K \\
          ... & ... & ... \\
          h_K^T h_K & ... & h_K^T h_K \\
      \end{matrix}
\right]</script></blockquote>
<p>è€ŒçŸ©é˜µçš„æ­£äº¤ç›¸ä¼¼å˜æ¢$A = P \Lambda P^{-1}$æ»¡è¶³</p>
<script type="math/tex; mode=display">
tr(A) = tr(\Lambda) = \sum_i \lambda_i</script><p>æ•…</p>
<script type="math/tex; mode=display">
tr(H^T L H) = tr(L) = \sum_{i=1}^M \lambda_i</script><p>$\lambda_i$ä¸ºçŸ©é˜µ$L$çš„ç‰¹å¾å€¼ã€‚</p>
<p>æˆ‘ä»¬å†è¿›è¡Œç»´åº¦è§„çº¦ï¼Œå°†ç»´åº¦ä»$M$é™åˆ°$k_1$ï¼Œå³æ‰¾åˆ°$k_1$ä¸ªæœ€å°çš„ç‰¹å¾å€¼ä¹‹å’Œã€‚</p>
<h5 id="N-Cut"><a href="#N-Cut" class="headerlink" title="N Cut"></a>N Cut</h5><p>æ¨å¯¼è¿‡ç¨‹ä¸<code>RatioCut</code>å®Œå…¨ä¸€è‡´ï¼Œåªæ˜¯å°†åˆ†æ¯$|V_i|$æ¢æˆ$vol(V_i)$</p>
<script type="math/tex; mode=display">
NCut(V_1, ..., V_K) = \frac{1}{2} \sum_k \frac{cut(V_i, \overline{V_i})}{vol(V_i)}</script><script type="math/tex; mode=display">
cut(V_i, \overline{V_i}) = W (V_i, \overline{V_i})</script><blockquote>
<script type="math/tex; mode=display">vol(V_{sub}) = \sum_{i \in V_{sub}} d_i</script></blockquote>
<h3 id="è®¡ç®—æ­¥éª¤-2"><a href="#è®¡ç®—æ­¥éª¤-2" class="headerlink" title="è®¡ç®—æ­¥éª¤"></a>è®¡ç®—æ­¥éª¤</h3><p>å¯¹äºç»™å®šçš„$N$ç»´æ•°æ®é›†$X = (x^{(1)}, x^{(2)}, â€¦, x^{(M)})$ï¼Œå°†å…¶åˆ’åˆ†ä¸º$K$ç±»$(C_1, â€¦, C_K)$</p>
<ol>
<li>æ ¹æ®è¾“å…¥çš„ç›¸ä¼¼çŸ©é˜µçš„ç”Ÿæˆæ–¹å¼æ„å»ºæ ·æœ¬çš„ç›¸ä¼¼çŸ©é˜µ$S_{MÃ—M}$ï¼›</li>
<li>æ ¹æ®ç›¸ä¼¼çŸ©é˜µ$S$æ„å»ºé‚»æ¥çŸ©é˜µ$W_{MÃ—M}$ï¼›</li>
<li>æ„å»ºåº¦çŸ©é˜µ$D_{MÃ—M}$ï¼›</li>
<li>è®¡ç®—æ‹‰æ™®æ‹‰æ–¯çŸ©é˜µ$L_{MÃ—M}$ï¼Œå¯è¿›è¡Œè§„èŒƒåŒ–$ L := D^{-1}L $ï¼›</li>
<li>å¯¹$L$è¿›è¡Œç‰¹å¾å€¼åˆ†è§£<code>(EVD)</code>ï¼Œå¾—åˆ°ç‰¹å¾å¯¹$ (\lambda_i, \alpha_i), i=1,â€¦,M $ï¼›</li>
<li>æŒ‡å®šè¶…å‚æ•°$K_1$ï¼Œé€‰å–$K_1$ä¸ªæœ€å°ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ç»„æˆçŸ©é˜µ$F_{MÃ—K_1}$ï¼Œå¹¶å°†å…¶æŒ‰è¡Œæ ‡å‡†åŒ–ï¼›</li>
<li>ä»¥$F$çš„è¡Œå‘é‡ä½œä¸ºæ–°çš„æ ·æœ¬æ•°($k_1$ç»´ï¼Œè¿™é‡Œä¹Ÿæœ‰é™ç»´æ“ä½œ)è¿›è¡Œèšç±»ï¼Œåˆ’åˆ†ä¸º$K$ç±»ï¼Œå¯ä½¿ç”¨<code>K-means</code>ï¼›</li>
<li>èšç±»ç»“æœå³ä¸ºè¾“å‡ºç»“æœ</li>
</ol>
<p>æ³¨æ„æ˜¯$K_1$ä¸ªæœ€å°ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ï¼Œåˆ«é—®æˆ‘ä¸ºä»€ä¹ˆçŸ¥é“ã€‚ã€‚ã€‚</p>
<h3 id="ä»£ç -2"><a href="#ä»£ç -2" class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p><a href="https://github.com/isLouisHsu/Python-Examples-for-Pattern-Recognition-Course/blob/master/examples/p86_spectral_clustering.py" target="_blank" rel="noopener">@Github: Spectral Clustering</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">class SpectralClustering():</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    Attributes:</span><br><span class="line">        k: &#123;int&#125;, k &lt; n_samples</span><br><span class="line">        sigma: &#123;float&#125;</span><br><span class="line">    Notes:</span><br><span class="line">        Steps:</span><br><span class="line">            - similarity matrix [W_&#123;nÃ—n&#125;]</span><br><span class="line">            - diagonal matrix [D_&#123;nÃ—n&#125;] is defined as</span><br><span class="line">                    D_&#123;ii&#125; = \begin&#123;cases&#125;</span><br><span class="line">                                \sum_j W_&#123;ij&#125; &amp; i \neq j \\</span><br><span class="line">                                0 &amp; i = j</span><br><span class="line">                            \end&#123;cases&#125;</span><br><span class="line">            - Laplacian matrix [L_&#123;nÃ—n&#125;], Laplacian matrix is defined as</span><br><span class="line">                    L = D - W or L = D^&#123;-1&#125; (D - W)</span><br><span class="line">            - EVD: L \alpha_i = \lambda_i \alpha_i</span><br><span class="line">            - takes the eigenvector corresponding to the largest eigenvalue as</span><br><span class="line">                    B_&#123;nÃ—k&#125; = [\beta_1, \beta_2, ..., \beta_k]</span><br><span class="line">            - apply K-Means to the row vectors of matrix B</span><br><span class="line">    &quot;&quot;&quot;</span><br><span class="line">    def __init__(self, k, n_clusters=2, sigma=1.0):</span><br><span class="line">        self.kmeans = KMeans(n_clusters=n_clusters)</span><br><span class="line">        self.k = k</span><br><span class="line">        self.sigma = sigma</span><br><span class="line">    def predict(self, X):</span><br><span class="line">        n_samples = X.shape[0]</span><br><span class="line">        # step 1</span><br><span class="line">        kernelGaussian = lambda z, sigma: np.exp(-0.5 * np.square(z/sigma))</span><br><span class="line">        W = np.zeros((n_samples, n_samples))</span><br><span class="line">        for i in range(n_samples):</span><br><span class="line">            for j in range(i):</span><br><span class="line">                W[i, j] = kernelGaussian(np.linalg.norm(X[i] - X[j]), self.sigma)</span><br><span class="line">                W[j, i] = W[i, j]</span><br><span class="line">        # step 2</span><br><span class="line">        D = np.diag(np.sum(W, axis=1))</span><br><span class="line">        # step 3</span><br><span class="line">        L = D - W</span><br><span class="line">        L = np.linalg.inv(D).dot(L)</span><br><span class="line">        # step 4</span><br><span class="line">        eigval, eigvec = np.linalg.eig(L)</span><br><span class="line">        # step 5</span><br><span class="line">        order = np.argsort(eigval)</span><br><span class="line">        eigvec = eigvec[:, order]</span><br><span class="line">        beta = eigvec[:, :self.k]</span><br><span class="line">        # step 6</span><br><span class="line">        self.kmeans.fit(beta)</span><br><span class="line">        return self.kmeans.labels_</span><br></pre></td></tr></table></figure></p>
<p><img src="/2018/11/16/Clustering/spectral_clustering.png" alt="spectral_clustering"></p>
<h2 id="DBSCAN"><a href="#DBSCAN" class="headerlink" title="DBSCAN"></a>DBSCAN</h2><p><code>DBSCAN(Density-Based Spatial Clustering of Applications with Noise)</code>ï¼Œå…·æœ‰å™ªå£°çš„åŸºäºå¯†åº¦çš„èšç±»æ–¹æ³•ã€‚å‡å®šç±»åˆ«å¯ä»¥é€šè¿‡æ ·æœ¬åˆ†å¸ƒçš„ç´§å¯†ç¨‹åº¦å†³å®šã€‚åŒä¸€ç±»åˆ«çš„æ ·æœ¬ï¼Œä»–ä»¬ä¹‹é—´çš„ç´§å¯†ç›¸è¿çš„ã€‚</p>
<blockquote>
<p><a href="https://www.cnblogs.com/pinard/p/6208966.html" target="_blank" rel="noopener">DBSCANå¯†åº¦èšç±»ç®—æ³• - åˆ˜å»ºå¹³Pinard - åšå®¢å›­</a></p>
</blockquote>
<h3 id="åŸç†-3"><a href="#åŸç†-3" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>å…ˆä»‹ç»å‡ ä¸ªå…³äºå¯†åº¦çš„æ¦‚å¿µ</p>
<ul>
<li><p>$\epsilon$-é‚»åŸŸ<br>  å¯¹äºæ ·æœ¬$x^{(i)}$ï¼Œå…¶$\epsilon$-é‚»åŸŸåŒ…å«æ ·æœ¬é›†ä¸­ä¸$x^{(i)}$è·ç¦»ä¸å¤§äº$\epsilon$çš„å­æ ·æœ¬é›†ï¼Œå…¶æ ·æœ¬ä¸ªæ•°è®°ä½œ$|N_{\epsilon}(x^{(i)})|$ã€‚</p>
<script type="math/tex; mode=display">
  N_{\epsilon}(x^{(i)}) = \{ x^{(j)} | d_{ij} \leq \epsilon \}</script></li>
<li><p>æ ¸å¿ƒå¯¹è±¡<br>  å¯¹äºä»»ä¸€æ ·æœ¬$x^{(i)}$ï¼Œè‹¥å…¶$\epsilon$-é‚»åŸŸ$N_{\epsilon}(x^{(i)})$è‡³å°‘åŒ…å«$minPts$ä¸ªæ ·æœ¬ï¼Œåˆ™è¯¥æ ·æœ¬ä¸ºæ ¸å¿ƒå¯¹è±¡ã€‚å¦‚å›¾ï¼Œé€‰æ‹©è‹¥é€‰å–$\epsilon=5$ï¼Œåˆ™çº¢ç‚¹å‡ä¸ºæ ¸å¿ƒå¯¹è±¡</p>
</li>
<li>å¯†åº¦ç›´è¾¾<br>  è‹¥æ ·æœ¬$x^{(j)} \in N_{\epsilon}(x^{(i)})$ï¼Œä¸”$x^{(i)}$ä¸ºæ ¸å¿ƒå¯¹è±¡ï¼Œåˆ™ç§°$x^{(j)}$ç”±$x^{(i)}$å¯†åº¦ç›´è¾¾ã€‚ä¸æ»¡è¶³å¯¹ç§°æ€§ï¼Œå³åä¹‹ä¸ä¸€å®šæˆç«‹ï¼Œé™¤é$x^{(j)}$ä¹Ÿä¸ºæ ¸å¿ƒå¯¹è±¡ã€‚å¦‚å›¾ï¼Œ$x^{(8)}$å¯ç”±$x^{(6)}$å¯†åº¦ç›´è¾¾ï¼Œè€Œåä¹‹$x^{(6)}$ä¸å¯ç”±$x^{(8)}$å¯†åº¦ç›´è¾¾ï¼Œå› ä¸º$x^{(8)}$ä¸ä¸ºæ ¸å¿ƒå¯¹è±¡ã€‚</li>
<li>å¯†åº¦å¯è¾¾<br>  è‹¥å­˜åœ¨æ ·æœ¬åºåˆ—$p_1, p_2, â€¦, p_T$ï¼Œæ»¡è¶³$p_1 = x^{(i)}, p_T = x^{(j)}$ï¼Œä¸”$p_{t+1}$å¯ç”±$p_t$å¯†åº¦ç›´è¾¾ï¼Œä¹Ÿå°±æ˜¯è¯´$p_1, p_2, â€¦, p_{T-1}$å‡ä¸ºæ ¸å¿ƒå¯¹è±¡ï¼Œåˆ™ç§°$x^{(j)}$ç”±$x^{(i)}$å¯†åº¦å¯è¾¾ã€‚ä¹Ÿä¸æ»¡è¶³å¯¹ç§°æ€§ã€‚å¦‚å›¾ï¼Œ$x^{(4)}$å¯ç”±$x^{(1)}$å¯†åº¦å¯è¾¾ï¼Œè€Œ$x^{(2)}$ä¸å¯ç”±$x^{(4)}$å¯†åº¦å¯è¾¾ï¼Œå› ä¸º$x^{(4)}$ä¸ä¸ºæ ¸å¿ƒå¯¹è±¡ã€‚</li>
<li>å¯†åº¦ç›¸è¿<br>  å­˜åœ¨æ ¸å¿ƒå¯¹è±¡$x^{(k)}$ï¼Œä½¿å¾—$x^{(i)}$ä¸$x^{(j)}$å‡ç”±$x^{(k)}$å¯†åº¦å¯è¾¾ï¼Œåˆ™ç§°$x^{(i)}$ä¸$x^{(j)}$å¯†åº¦ç›¸è¿ã€‚æ³¨æ„å¯†åº¦ç›¸è¿æ»¡è¶³å¯¹ç§°æ€§ã€‚å¦‚å›¾ï¼Œ$x^{(8)}$ä¸$x^{(4)}$å‡å¯ç”±$x^{(1)}$å¯†åº¦å¯è¾¾ï¼Œåˆ™$x^{(8)}$ä¸$x^{(4)}$å¯†åº¦ç›¸è¿ã€‚</li>
</ul>
<p><img src="/2018/11/16/Clustering/DBSCAN1.jpg" alt="DBSCAN1"></p>
<h3 id="è®¡ç®—æ€æƒ³"><a href="#è®¡ç®—æ€æƒ³" class="headerlink" title="è®¡ç®—æ€æƒ³"></a>è®¡ç®—æ€æƒ³</h3><p><code>DBSCAN</code>çš„èšç±»æ€æƒ³æ˜¯ï¼Œç”±<strong>å¯†åº¦å¯è¾¾å…³ç³»</strong>å¯¼å‡ºçš„æœ€å¤§å¯†åº¦ç›¸è¿çš„æ ·æœ¬é›†åˆï¼Œå³ä¸ºæˆ‘ä»¬æœ€ç»ˆèšç±»çš„ä¸€ä¸ªç°‡ï¼Œè¿™ä¸ªç°‡é‡Œå¯èƒ½åªæœ‰ä¸€ä¸ªæ ¸å¿ƒå¯¹è±¡ï¼Œä¹Ÿå¯èƒ½æœ‰å¤šä¸ªæ ¸å¿ƒå¯¹è±¡ï¼Œè‹¥æœ‰å¤šä¸ªï¼Œåˆ™ç°‡é‡Œçš„ä»»æ„ä¸€ä¸ªæ ¸å¿ƒå¯¹è±¡çš„$\epsilon$-é‚»åŸŸä¸­ä¸€å®šæœ‰ä¸€ä¸ªå…¶ä»–çš„æ ¸å¿ƒå¯¹è±¡ï¼Œå¦åˆ™è¿™ä¸¤ä¸ªæ ¸å¿ƒå¯¹è±¡æ— æ³•å¯†åº¦å¯è¾¾ã€‚</p>
<p>å¦å¤–ï¼Œè€ƒè™‘ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜</p>
<ul>
<li>å™ªéŸ³ç‚¹<br>  ä¸€äº›å¼‚å¸¸æ ·æœ¬ç‚¹æˆ–è€…è¯´å°‘é‡æ¸¸ç¦»äºç°‡å¤–çš„æ ·æœ¬ç‚¹ï¼Œè¿™äº›ç‚¹ä¸åœ¨ä»»ä½•ä¸€ä¸ªæ ¸å¿ƒå¯¹è±¡åœ¨å‘¨å›´ï¼Œè¿™äº›æ ·æœ¬ç‚¹æ ‡è®°ä¸ºå™ªéŸ³ç‚¹ï¼Œ<code>with Noise</code>å°±æ˜¯è¿™ä¸ªæ„æ€ã€‚</li>
<li>è·ç¦»çš„åº¦é‡<br>  ä¸€èˆ¬é‡‡ç”¨æœ€è¿‘é‚»æ€æƒ³ï¼Œé‡‡ç”¨æŸä¸€ç§è·ç¦»åº¦é‡æ¥è¡¡é‡æ ·æœ¬è·ç¦»ï¼Œæ¯”å¦‚æ¬§å¼è·ç¦»ã€‚è¿™å’Œ<code>KNN</code>ç®—æ³•çš„æœ€è¿‘é‚»æ€æƒ³å®Œå…¨ç›¸åŒã€‚å¯¹åº”å°‘é‡çš„æ ·æœ¬ï¼Œå¯»æ‰¾æœ€è¿‘é‚»å¯ä»¥ç›´æ¥å»è®¡ç®—æ‰€æœ‰æ ·æœ¬çš„è·ç¦»ï¼Œå¦‚æœæ ·æœ¬é‡è¾ƒå¤§ï¼Œåˆ™ä¸€èˆ¬é‡‡ç”¨<code>KDTree</code>æˆ–è€…çƒæ ‘æ¥å¿«é€Ÿçš„æœç´¢æœ€è¿‘é‚»ã€‚</li>
<li>ç±»åˆ«é‡å¤æ—¶çš„åˆ¤åˆ«<br>  æŸäº›æ ·æœ¬å¯èƒ½åˆ°ä¸¤ä¸ªæ ¸å¿ƒå¯¹è±¡çš„è·ç¦»éƒ½å°äº$\epsilon$ï¼Œä½†æ˜¯è¿™ä¸¤ä¸ªæ ¸å¿ƒå¯¹è±¡å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œä¸æ˜¯å¯†åº¦ç›´è¾¾ï¼Œåˆä¸å±äºåŒä¸€ä¸ªèšç±»ç°‡ï¼Œé‚£ä¹ˆå¦‚æœç•Œå®šè¿™ä¸ªæ ·æœ¬çš„ç±»åˆ«å‘¢ï¼Ÿ<br>  <img src="/2018/11/16/Clustering/DBSCAN2.jpg" alt="DBSCAN2"><br>  ä¸€èˆ¬æ¥è¯´ï¼Œæ­¤æ—¶<code>DBSCAN</code>é‡‡ç”¨<strong>å…ˆæ¥ååˆ°</strong>ï¼Œå…ˆè¿›è¡Œèšç±»çš„ç±»åˆ«ç°‡ä¼šæ ‡è®°è¿™ä¸ªæ ·æœ¬ä¸ºå®ƒçš„ç±»åˆ«ã€‚ä¹Ÿå°±æ˜¯è¯´<code>BDSCAN</code>ä¸æ˜¯å®Œå…¨ç¨³å®šçš„ç®—æ³•ã€‚</li>
</ul>
<h3 id="ç®—æ³•æ­¥éª¤"><a href="#ç®—æ³•æ­¥éª¤" class="headerlink" title="ç®—æ³•æ­¥éª¤"></a>ç®—æ³•æ­¥éª¤</h3><p>å¯¹äºç»™å®šçš„$N$ç»´æ•°æ®é›†$X = (x^{(1)}, x^{(2)}, â€¦, x^{(M)})$ï¼ŒæŒ‡å®šé‚»åŸŸå‚æ•°$(\epsilon, minPts)$ä¸æ ·æœ¬è·ç¦»åº¦é‡æ–¹å¼ï¼Œå°†å…¶åˆ’åˆ†ä¸º$K$ç±»ã€‚</p>
<ol>
<li>æ£€æµ‹æ•°æ®åº“ä¸­å°šæœªæ£€æŸ¥è¿‡çš„å¯¹è±¡$p$ï¼Œå¦‚æœ$p$æœªè¢«å¤„ç†(å½’ä¸ºæŸä¸ªç°‡æˆ–è€…æ ‡è®°ä¸ºå™ªå£°)ï¼Œåˆ™æ£€æŸ¥å…¶é‚»åŸŸï¼š<ul>
<li>è‹¥åŒ…å«çš„å¯¹è±¡æ•°ä¸å°äº$minPts$ï¼Œå»ºç«‹æ–°ç°‡$C$ï¼Œå°†å…¶ä¸­çš„æ‰€æœ‰ç‚¹åŠ å…¥å€™é€‰é›†$N$ï¼›</li>
</ul>
</li>
<li>å¯¹å€™é€‰é›†$N$ä¸­æ‰€æœ‰å°šæœªè¢«å¤„ç†çš„å¯¹è±¡$q$ï¼Œæ£€æŸ¥å…¶é‚»åŸŸï¼š<ul>
<li>è‹¥è‡³å°‘åŒ…å«$minPts$ä¸ªå¯¹è±¡ï¼Œåˆ™å°†è¿™äº›å¯¹è±¡åŠ å…¥$N$ï¼›</li>
<li>å¦‚æœ$q$æœªå½’å…¥ä»»ä½•ä¸€ä¸ªç°‡ï¼Œåˆ™å°†$q$åŠ å…¥$C$ï¼›</li>
</ul>
</li>
<li>é‡å¤æ­¥éª¤$2$ï¼Œç»§ç»­æ£€æŸ¥$N$ä¸­æœªå¤„ç†çš„å¯¹è±¡ï¼Œç›´åˆ°å½“å‰å€™é€‰é›†$N$ä¸ºç©ºï¼›</li>
<li>é‡å¤æ­¥éª¤$1$-$3$ï¼Œç›´åˆ°æ‰€æœ‰å¯¹è±¡éƒ½å½’å…¥äº†æŸä¸ªç°‡æˆ–æ ‡è®°ä¸ºå™ªå£°ã€‚</li>
</ol>
<h2 id="é«˜æ–¯æ··åˆæ¨¡å‹-GMM"><a href="#é«˜æ–¯æ··åˆæ¨¡å‹-GMM" class="headerlink" title="é«˜æ–¯æ··åˆæ¨¡å‹(GMM)"></a>é«˜æ–¯æ··åˆæ¨¡å‹(GMM)</h2><p>è¯¦æƒ…æŸ¥çœ‹<a href="https://louishsu.xyz/2018/11/12/EM%E7%AE%97%E6%B3%95-GMM%E6%A8%A1%E5%9E%8B/" target="_blank" rel="noopener">EMç®—æ³• &amp; GMMæ¨¡å‹</a>ã€‚</p>
<h2 id="å±‚æ¬¡èšç±»-Hierarchical-Clustering"><a href="#å±‚æ¬¡èšç±»-Hierarchical-Clustering" class="headerlink" title="å±‚æ¬¡èšç±»(Hierarchical Clustering)"></a>å±‚æ¬¡èšç±»(Hierarchical Clustering)</h2><p>å±‚æ¬¡èšç±»æ›´å¤šçš„æ˜¯ä¸€ç§æ€æƒ³ï¼Œè€Œä¸æ˜¯æ–¹æ³•ï¼Œé€šè¿‡ä»ä¸‹å¾€ä¸Šä¸æ–­åˆå¹¶ç°‡ï¼Œæˆ–è€…ä»ä¸Šå¾€ä¸‹ä¸æ–­åˆ†ç¦»ç°‡å½¢æˆåµŒå¥—çš„ç°‡ã€‚ä¾‹å¦‚ä¸Šé¢è®²åˆ°çš„<code>DBSCAN</code>æœ€åç°‡çš„åˆå¹¶å°±æœ‰è¿™ç§æ€æƒ³ã€‚</p>
<p>å±‚æ¬¡çš„ç±»é€šè¿‡â€œæ ‘çŠ¶å›¾â€æ¥è¡¨ç¤ºï¼Œå¦‚ä¸‹<br><img src="/2018/11/16/Clustering/å±‚æ¬¡èšç±».png" alt="å±‚æ¬¡èšç±»"></p>
<p>ä¸»è¦çš„æ€æƒ³æˆ–æ–¹æ³•æœ‰ä¸¤ç§</p>
<ul>
<li>è‡ªåº•å‘ä¸Šçš„å‡èšæ–¹æ³•<code>(agglomerative hierarchical clustering)</code><br>  å¦‚<code>AGNES</code>ã€‚</li>
<li>è‡ªä¸Šå‘ä¸‹çš„åˆ†è£‚æ–¹æ³•<code>(divisive hierarchical clustering)</code><br>  å¦‚<code>DIANA</code>ã€‚</li>
</ul>
<h2 id="å›¾å›¢ä½“æ£€æµ‹-Graph-Community-Detection"><a href="#å›¾å›¢ä½“æ£€æµ‹-Graph-Community-Detection" class="headerlink" title="å›¾å›¢ä½“æ£€æµ‹(Graph Community Detection)"></a>å›¾å›¢ä½“æ£€æµ‹(Graph Community Detection)</h2><p>ç•¥</p>

        </div>
        <div class="post-tool">
            <a class="btn-thumbs-up" href="javascript:void(0);" data-cid="52" title="95">
                <i class="fa fa-thumbs-up" aria-hidden="true"></i> Donate
            </a>
        </div>
        
        <div class="post-tags">Tagsï¼š
            
        </div>
        
    </article>
    
    <p style="text-align: center">This article just represents my own viewpoint. If there is something wrong, please correct me.</p>
    
    

    

</div>
<script src="/js/busuanzi.pure.mini.js"></script>


        </div><!-- end #main-->
    </div><!-- end #body -->
    <footer class="footer">
    <div class="footer-inner" style="text-align: center">
        <p>
            <a href="/about" title="About">About</a>&nbsp;&nbsp<em>Â·</em>&nbsp;&nbsp
            <!-- è‡ªå®šä¹‰é“¾æ¥ -->
            <a href="/help" title="Help">Help</a>&nbsp;&nbsp<em>Â·</em>&nbsp;&nbsp
            <a href="/links" title="Links">Links</a>&nbsp;&nbsp<em>Â·</em>&nbsp;&nbsp
            <a href="/sitemap.xml" title="SiteMap">SiteMap</a>
        </p>
        <p>
            Has been established&nbsp<a href="/timeline" id="siteBuildingTime"></a>&nbspDaysï¼Œ<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="licence">Based on Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</a><br>
            Â©2017-<span id="cpYear"></span> Based on&nbsp<a href="http://hexo.io" target="_blank" rel="nofollow">Hexo</a>
            ï¼ŒTheme by&nbsp&nbsp<a href="https://github.com/tangkunyin/hexo-theme-jsimple" target="_blank" rel="bookmark">JSimple</a>
            ï¼ŒAuthor&nbsp<a href="https://shuoit.net" target="_blank" rel="friend">çº ç»“ä¼¦</a>
            ï¼ŒHosted by <a href="https://pages.github.com/" target="_blank" rel="nofollow">GitHub Pages</a>
        </p>
    </div>
</footer>
<script src="/js/SimpleCore.js"></script>

</div>
<!-- search pop -->
<div class="popup search-popup local-search-popup">
    <div class="local-search-header clearfix">
        <span class="search-icon">
            <i class="fa fa-search"></i>
        </span>
        <span class="popup-btn-close">
            <i class="fa fa-times-circle"></i>
        </span>
        <div class="local-search-input-wrapper">
            <input id="local-search-input" spellcheck="false" type="text" autocomplete="off" placeholder="Input query keywords here...">
        </div>
    </div>
    <div id="local-search-result"></div>
</div>
<div class="fixed-btn">
    <a class="btn-gotop" href="javascript:"> <i class="fa fa-angle-up"></i></a>
</div>
<script>
    $(function () {
        var jsi_config = {
            buildingTime: '01/20/2018',
            current: $('.post-tags').length > 0 ? 'post' : 'archive',
            snsQRCode: '/images/sns-qrcode.png',
            donateImg: '/images/donate-qr.png',
            localSearch: { dbPath: '' },
            readMode: 'day'
        };
        
            jsi_config.localSearch = {
                dbPath: '/search.xml',
                trigger: 'auto',
                topN: '1',
                unescape: 'false'
            }
        
        SimpleCore.init(jsi_config);
        
    });
</script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
